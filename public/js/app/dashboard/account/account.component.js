"use strict";var __decorate=this&&this.__decorate||function(e,t,r,o){var c,n=arguments.length,i=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var u=e.length-1;u>=0;u--)(c=e[u])&&(i=(n<3?c(i):n>3?c(t,r,i):c(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),router_1=require("@angular/router"),moment=require("moment"),auth_service_1=require("../../shared/services/auth.service"),socket_service_1=require("../../shared/services/socket.service"),AccountComponent=function(){function e(e,t,r){this.router=e,this.authService=t,this.socket=r,this.currentUser={}}return e.prototype.generateTime=function(e){return moment(e).format("LLL")},e.prototype.generateDate=function(e){return moment(e).format("LL")},e.prototype.getCurrentUser=function(){var e=this;this.authService.getCurrentUser(JSON.parse(localStorage.getItem("current_user"))._id).subscribe(function(t){console.log(t),e.currentUser=t},function(t){e.authService.logUserOut(),console.log(t)})},e.prototype.onSubmit=function(e,t){function r(e){o[t]=!o[t]}var o=this;this.authService.updateUser(e).subscribe(function(e){return r(e)},function(e){return console.log("err @updateUser: ",e)})},e.prototype.edit=function(e){this[e]=!this[e]},e.prototype.checkRole=function(e,t){return!!t&&this.authService.checkAuthority(e,t.role)},e.prototype.addStudent=function(e){var t=this;e&&this.authService.getUserByEmail(e).subscribe(function(e){},function(e){t.emailError=!0})},e.prototype.ngOnInit=function(){var e=this;this.currentUser=JSON.parse(localStorage.getItem("current_user")),this.getCurrentUser(),this.socket.syncById("user",this.currentUser._id,function(t){e.currentUser=t})},e=__decorate([core_1.Component({moduleId:module.id,selector:"yeah-account",templateUrl:"account.component.html",styleUrls:["account.style.css"],providers:[auth_service_1.AuthService,socket_service_1.SocketService]}),__metadata("design:paramtypes",[router_1.Router,auth_service_1.AuthService,socket_service_1.SocketService])],e)}();exports.AccountComponent=AccountComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRhc2hib2FyZC9hY2NvdW50L2FjY291bnQuY29tcG9uZW50LmpzIiwiZGFzaGJvYXJkL2FjY291bnQvYWNjb3VudC5jb21wb25lbnQudHMiXSwibmFtZXMiOlsiX19kZWNvcmF0ZSIsInRoaXMiLCJkZWNvcmF0b3JzIiwidGFyZ2V0Iiwia2V5IiwiZGVzYyIsImQiLCJjIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiciIsIk9iamVjdCIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsIlJlZmxlY3QiLCJkZWNvcmF0ZSIsImkiLCJkZWZpbmVQcm9wZXJ0eSIsIl9fbWV0YWRhdGEiLCJrIiwidiIsIm1ldGFkYXRhIiwiY29yZV8xIiwicmVxdWlyZSIsInJvdXRlcl8xIiwibW9tZW50IiwiYXV0aF9zZXJ2aWNlXzEiLCJzb2NrZXRfc2VydmljZV8xIiwiQWNjb3VudENvbXBvbmVudCIsInJvdXRlciIsImF1dGhTZXJ2aWNlIiwic29ja2V0IiwiY3VycmVudFVzZXIiLCJwcm90b3R5cGUiLCJnZW5lcmF0ZVRpbWUiLCJ1bml4IiwiZm9ybWF0IiwiZ2VuZXJhdGVEYXRlIiwiZ2V0Q3VycmVudFVzZXIiLCJfdGhpcyIsIkpTT04iLCJwYXJzZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJfaWQiLCJzdWJzY3JpYmUiLCJ1c2VyIiwiY29uc29sZSIsImxvZyIsImVycm9yIiwibG9nVXNlck91dCIsIm9uU3VibWl0IiwidmFsdWUiLCJjYXJkTmFtZSIsImhhbmRsZVJlc3BvbnNlIiwicmVzIiwic2VsZiIsInVwZGF0ZVVzZXIiLCJlcnIiLCJlZGl0IiwiY2hlY2tSb2xlIiwicm9sZSIsImNoZWNrQXV0aG9yaXR5IiwiYWRkU3R1ZGVudCIsImVtYWlsIiwiZ2V0VXNlckJ5RW1haWwiLCJlbWFpbEVycm9yIiwibmdPbkluaXQiLCJzeW5jQnlJZCIsIkNvbXBvbmVudCIsIm1vZHVsZUlkIiwibW9kdWxlIiwiaWQiLCJzZWxlY3RvciIsInRlbXBsYXRlVXJsIiwic3R5bGVVcmxzIiwicHJvdmlkZXJzIiwiQXV0aFNlcnZpY2UiLCJTb2NrZXRTZXJ2aWNlIiwiUm91dGVyIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUEsWUFDQSxJQUFJQSxZQUFjQyxNQUFRQSxLQUFLRCxZQUFlLFNBQVVFLEVBQVlDLEVBQVFDLEVBQUtDLEdBQzdFLEdBQTJIQyxHQUF2SEMsRUFBSUMsVUFBVUMsT0FBUUMsRUFBSUgsRUFBSSxFQUFJSixFQUFrQixPQUFURSxFQUFnQkEsRUFBT00sT0FBT0MseUJBQXlCVCxFQUFRQyxHQUFPQyxDQUNySCxJQUF1QixnQkFBWlEsVUFBb0Qsa0JBQXJCQSxTQUFRQyxTQUF5QkosRUFBSUcsUUFBUUMsU0FBU1osRUFBWUMsRUFBUUMsRUFBS0MsT0FDcEgsS0FBSyxHQUFJVSxHQUFJYixFQUFXTyxPQUFTLEVBQUdNLEdBQUssRUFBR0EsS0FBU1QsRUFBSUosRUFBV2EsTUFBSUwsR0FBS0gsRUFBSSxFQUFJRCxFQUFFSSxHQUFLSCxFQUFJLEVBQUlELEVBQUVILEVBQVFDLEVBQUtNLEdBQUtKLEVBQUVILEVBQVFDLEtBQVNNLEVBQ2hKLE9BQU9ILEdBQUksR0FBS0csR0FBS0MsT0FBT0ssZUFBZWIsRUFBUUMsRUFBS00sR0FBSUEsR0FFNURPLFdBQWNoQixNQUFRQSxLQUFLZ0IsWUFBZSxTQUFVQyxFQUFHQyxHQUN2RCxHQUF1QixnQkFBWk4sVUFBb0Qsa0JBQXJCQSxTQUFRTyxTQUF5QixNQUFPUCxTQUFRTyxTQUFTRixFQUFHQyxJQ1IxR0UsT0FBQUMsUUFBNkMsaUJBQzdDQyxTQUFBRCxRQUEwQixtQkFDbkJFLE9BQU1GLFFBQVcsVUFHeEJHLGVBQUFILFFBQTRCLHNDQUM1QkksaUJBQUFKLFFBQThCLHdDQVM5QkssaUJBQUEsV0FNSSxRQUFBQSxHQUNZQyxFQUNBQyxFQUNBQyxHQUZBN0IsS0FBQTJCLE9BQUFBLEVBQ0EzQixLQUFBNEIsWUFBQUEsRUFDQTVCLEtBQUE2QixPQUFBQSxFQVJaN0IsS0FBQThCLGVBdUZKLE1BNUVJSixHQUFBSyxVQUFBQyxhQUFBLFNBQWFDLEdBQ1QsTUFBT1YsUUFBT1UsR0FBTUMsT0FBTyxRQUcvQlIsRUFBQUssVUFBQUksYUFBQSxTQUFhRixHQUNULE1BQU9WLFFBQU9VLEdBQU1DLE9BQU8sT0FHL0JSLEVBQUFLLFVBQUFLLGVBQUEsV0FBQSxHQUFBQyxHQUFBckMsSUFDSUEsTUFBSzRCLFlBQVlRLGVBQWVFLEtBQUtDLE1BQU1DLGFBQWFDLFFBQVEsaUJBQWlCQyxLQUM1RUMsVUFDRCxTQUFBQyxHQUNJQyxRQUFRQyxJQUFJRixHQUVaUCxFQUFLUCxZQUFjYyxHQUV2QixTQUFBRyxHQUNJVixFQUFLVCxZQUFZb0IsYUFDakJILFFBQVFDLElBQVNDLE1BSTdCckIsRUFBQUssVUFBQWtCLFNBQUEsU0FBU0MsRUFBWUMsR0FVakIsUUFBQUMsR0FBd0JDLEdBRXBCQyxFQUFLSCxJQUFjRyxFQUFLSCxHQVY1QixHQUFJRyxHQUFPdEQsSUFFWEEsTUFBSzRCLFlBQVkyQixXQUFXTCxHQUN2QlAsVUFDRyxTQUFBVSxHQUFPLE1BQUFELEdBQWVDLElBQ3RCLFNBQUFHLEdBQU8sTUFBQVgsU0FBUUMsSUFBSSxvQkFBcUJVLE1BU3BEOUIsRUFBQUssVUFBQTBCLEtBQUEsU0FBS04sR0FDRG5ELEtBQUttRCxJQUFjbkQsS0FBS21ELElBRzVCekIsRUFBQUssVUFBQTJCLFVBQUEsU0FBVUMsRUFBY2YsR0FHcEIsUUFBR0EsR0FDUTVDLEtBQUs0QixZQUFZZ0MsZUFBZUQsRUFBTWYsRUFBS2UsT0FNMURqQyxFQUFBSyxVQUFBOEIsV0FBQSxTQUFXQyxHQUFYLEdBQUF6QixHQUFBckMsSUFDTzhELElBRUM5RCxLQUFLNEIsWUFBWW1DLGVBQWVELEdBQy9CbkIsVUFDRCxTQUFBQyxLQUlBLFNBQUFHLEdBQ0lWLEVBQUsyQixZQUFhLEtBTTlCdEMsRUFBQUssVUFBQWtDLFNBQUEsV0FDSSxHQUFJWCxHQUFPdEQsSUFDWEEsTUFBSzhCLFlBQWNRLEtBQUtDLE1BQU1DLGFBQWFDLFFBQVEsaUJBQ25EekMsS0FBS29DLGlCQUNMcEMsS0FBSzZCLE9BQU9xQyxTQUFTLE9BQVFsRSxLQUFLOEIsWUFBWVksSUFBSyxTQUFTRSxHQUN4RFUsRUFBS3hCLFlBQWNjLEtBNUYvQmxCLEVBQUEzQixZQUFDcUIsT0FBQStDLFdBQ0dDLFNBQVVDLE9BQU9DLEdBQ2pCQyxTQUFVLGVBQ1ZDLFlBQWEseUJBQ2JDLFdBQVkscUJBQ1pDLFdBQVlsRCxlQUFBbUQsWUFBYWxELGlCQUFBbUQsaUJENkVyQjVELFdBQVcscUJBQXNCTSxTQUFTdUQsT0FBUXJELGVBQWVtRCxZQUFhbEQsaUJBQWlCbUQsaUJBQ2hHbEQsS0M1RU1vRCxTQUFBcEQsaUJBQWdCQSIsImZpbGUiOiJkYXNoYm9hcmQvYWNjb3VudC9hY2NvdW50LmNvbXBvbmVudC5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xudmFyIF9fZGVjb3JhdGUgPSAodGhpcyAmJiB0aGlzLl9fZGVjb3JhdGUpIHx8IGZ1bmN0aW9uIChkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xuICAgIHZhciBjID0gYXJndW1lbnRzLmxlbmd0aCwgciA9IGMgPCAzID8gdGFyZ2V0IDogZGVzYyA9PT0gbnVsbCA/IGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHRhcmdldCwga2V5KSA6IGRlc2MsIGQ7XG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xuICAgIHJldHVybiBjID4gMyAmJiByICYmIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgciksIHI7XG59O1xudmFyIF9fbWV0YWRhdGEgPSAodGhpcyAmJiB0aGlzLl9fbWV0YWRhdGEpIHx8IGZ1bmN0aW9uIChrLCB2KSB7XG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKGssIHYpO1xufTtcbnZhciBjb3JlXzEgPSByZXF1aXJlKCdAYW5ndWxhci9jb3JlJyk7XG52YXIgcm91dGVyXzEgPSByZXF1aXJlKCdAYW5ndWxhci9yb3V0ZXInKTtcbnZhciBtb21lbnQgPSByZXF1aXJlKCdtb21lbnQnKTtcbnZhciBhdXRoX3NlcnZpY2VfMSA9IHJlcXVpcmUoJy4uLy4uL3NoYXJlZC9zZXJ2aWNlcy9hdXRoLnNlcnZpY2UnKTtcbnZhciBzb2NrZXRfc2VydmljZV8xID0gcmVxdWlyZSgnLi4vLi4vc2hhcmVkL3NlcnZpY2VzL3NvY2tldC5zZXJ2aWNlJyk7XG52YXIgQWNjb3VudENvbXBvbmVudCA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gQWNjb3VudENvbXBvbmVudChyb3V0ZXIsIGF1dGhTZXJ2aWNlLCBzb2NrZXQpIHtcbiAgICAgICAgdGhpcy5yb3V0ZXIgPSByb3V0ZXI7XG4gICAgICAgIHRoaXMuYXV0aFNlcnZpY2UgPSBhdXRoU2VydmljZTtcbiAgICAgICAgdGhpcy5zb2NrZXQgPSBzb2NrZXQ7XG4gICAgICAgIHRoaXMuY3VycmVudFVzZXIgPSB7fTtcbiAgICB9XG4gICAgQWNjb3VudENvbXBvbmVudC5wcm90b3R5cGUuZ2VuZXJhdGVUaW1lID0gZnVuY3Rpb24gKHVuaXgpIHtcbiAgICAgICAgcmV0dXJuIG1vbWVudCh1bml4KS5mb3JtYXQoJ0xMTCcpO1xuICAgIH07XG4gICAgQWNjb3VudENvbXBvbmVudC5wcm90b3R5cGUuZ2VuZXJhdGVEYXRlID0gZnVuY3Rpb24gKHVuaXgpIHtcbiAgICAgICAgcmV0dXJuIG1vbWVudCh1bml4KS5mb3JtYXQoJ0xMJyk7XG4gICAgfTtcbiAgICBBY2NvdW50Q29tcG9uZW50LnByb3RvdHlwZS5nZXRDdXJyZW50VXNlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5hdXRoU2VydmljZS5nZXRDdXJyZW50VXNlcihKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjdXJyZW50X3VzZXInKSkuX2lkKVxuICAgICAgICAgICAgLnN1YnNjcmliZShmdW5jdGlvbiAodXNlcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2codXNlcik7XG4gICAgICAgICAgICBfdGhpcy5jdXJyZW50VXNlciA9IHVzZXI7XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgX3RoaXMuYXV0aFNlcnZpY2UubG9nVXNlck91dCgpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEFjY291bnRDb21wb25lbnQucHJvdG90eXBlLm9uU3VibWl0ID0gZnVuY3Rpb24gKHZhbHVlLCBjYXJkTmFtZSkge1xuICAgICAgICAvLyBTZW5kIHVwZGF0ZWQgdXNlciBvYmplY3QgdG8gYmFja2VuZFxuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuYXV0aFNlcnZpY2UudXBkYXRlVXNlcih2YWx1ZSlcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoZnVuY3Rpb24gKHJlcykgeyByZXR1cm4gaGFuZGxlUmVzcG9uc2UocmVzKTsgfSwgZnVuY3Rpb24gKGVycikgeyByZXR1cm4gY29uc29sZS5sb2coJ2VyciBAdXBkYXRlVXNlcjogJywgZXJyKTsgfSk7XG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZVJlc3BvbnNlKHJlcykge1xuICAgICAgICAgICAgLy8gQWZ0ZXIgc2F2aW5nIHN1Y2Nlc3NmdWxseSBDbG9zZSB0aGUgc3BlY2lmaWMgY2FyZChmb3JtKVxuICAgICAgICAgICAgc2VsZltjYXJkTmFtZV0gPSAhKHNlbGZbY2FyZE5hbWVdKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWNjb3VudENvbXBvbmVudC5wcm90b3R5cGUuZWRpdCA9IGZ1bmN0aW9uIChjYXJkTmFtZSkge1xuICAgICAgICB0aGlzW2NhcmROYW1lXSA9ICEodGhpc1tjYXJkTmFtZV0pO1xuICAgIH07XG4gICAgQWNjb3VudENvbXBvbmVudC5wcm90b3R5cGUuY2hlY2tSb2xlID0gZnVuY3Rpb24gKHJvbGUsIHVzZXIpIHtcbiAgICAgICAgLy9yb2xlIGlzIHRoZSByZXF1aXJlZCByb2xlIHRvIGFjY2VzcyB0aGUgY29udGVudFxuICAgICAgICAvL1VzZXIncyByb2xlIG11c3QgaGF2ZSBoaWdoZXIgb3IgZXF1YWwgYXV0aG9yaXR5IHRvIHRoaXMgcm9sZVxuICAgICAgICBpZiAodXNlcikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuYXV0aFNlcnZpY2UuY2hlY2tBdXRob3JpdHkocm9sZSwgdXNlci5yb2xlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgQWNjb3VudENvbXBvbmVudC5wcm90b3R5cGUuYWRkU3R1ZGVudCA9IGZ1bmN0aW9uIChlbWFpbCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoZW1haWwpIHtcbiAgICAgICAgICAgIC8vRmluZCB1c2VyIGJ5IGVtYWlsXG4gICAgICAgICAgICB0aGlzLmF1dGhTZXJ2aWNlLmdldFVzZXJCeUVtYWlsKGVtYWlsKVxuICAgICAgICAgICAgICAgIC5zdWJzY3JpYmUoZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgICAgICAgICAvL0FkZCB1c2VyIHRvIHRoaXMgdXNlcidzIHN0dWRlbnRcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgICAgIF90aGlzLmVtYWlsRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjY291bnRDb21wb25lbnQucHJvdG90eXBlLm5nT25Jbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuY3VycmVudFVzZXIgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjdXJyZW50X3VzZXInKSk7XG4gICAgICAgIHRoaXMuZ2V0Q3VycmVudFVzZXIoKTtcbiAgICAgICAgdGhpcy5zb2NrZXQuc3luY0J5SWQoJ3VzZXInLCB0aGlzLmN1cnJlbnRVc2VyLl9pZCwgZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgICAgIHNlbGYuY3VycmVudFVzZXIgPSB1c2VyO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIEFjY291bnRDb21wb25lbnQgPSBfX2RlY29yYXRlKFtcbiAgICAgICAgY29yZV8xLkNvbXBvbmVudCh7XG4gICAgICAgICAgICBtb2R1bGVJZDogbW9kdWxlLmlkLFxuICAgICAgICAgICAgc2VsZWN0b3I6ICd5ZWFoLWFjY291bnQnLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhY2NvdW50LmNvbXBvbmVudC5odG1sJyxcbiAgICAgICAgICAgIHN0eWxlVXJsczogWydhY2NvdW50LnN0eWxlLmNzcyddLFxuICAgICAgICAgICAgcHJvdmlkZXJzOiBbYXV0aF9zZXJ2aWNlXzEuQXV0aFNlcnZpY2UsIHNvY2tldF9zZXJ2aWNlXzEuU29ja2V0U2VydmljZV1cbiAgICAgICAgfSksIFxuICAgICAgICBfX21ldGFkYXRhKCdkZXNpZ246cGFyYW10eXBlcycsIFtyb3V0ZXJfMS5Sb3V0ZXIsIGF1dGhfc2VydmljZV8xLkF1dGhTZXJ2aWNlLCBzb2NrZXRfc2VydmljZV8xLlNvY2tldFNlcnZpY2VdKVxuICAgIF0sIEFjY291bnRDb21wb25lbnQpO1xuICAgIHJldHVybiBBY2NvdW50Q29tcG9uZW50O1xufSgpKTtcbmV4cG9ydHMuQWNjb3VudENvbXBvbmVudCA9IEFjY291bnRDb21wb25lbnQ7XG4iLCJpbXBvcnQgeyBDb21wb25lbnQsIE9uSW5pdCwgT25EZXN0cm95IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBSb3V0ZXIgfSAgICBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xuaW1wb3J0IG1vbWVudCA9IHJlcXVpcmUoJ21vbWVudCcpO1xuXG5pbXBvcnQgeyBVc2VyIH0gZnJvbSAnLi4vLi4vc2hhcmVkL3R5cGVzL3VzZXInXG5pbXBvcnQgeyBBdXRoU2VydmljZSB9IGZyb20gJy4uLy4uL3NoYXJlZC9zZXJ2aWNlcy9hdXRoLnNlcnZpY2UnO1xuaW1wb3J0IHsgU29ja2V0U2VydmljZSB9IGZyb20gJy4uLy4uL3NoYXJlZC9zZXJ2aWNlcy9zb2NrZXQuc2VydmljZSc7XG5cbkBDb21wb25lbnQoe1xuICAgIG1vZHVsZUlkOiBtb2R1bGUuaWQsXG4gICAgc2VsZWN0b3I6ICd5ZWFoLWFjY291bnQnLFxuICAgIHRlbXBsYXRlVXJsOiAnYWNjb3VudC5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJ2FjY291bnQuc3R5bGUuY3NzJ10sXG4gICAgcHJvdmlkZXJzOiBbQXV0aFNlcnZpY2UsIFNvY2tldFNlcnZpY2VdXG59KVxuZXhwb3J0IGNsYXNzIEFjY291bnRDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQge1xuICAgIGN1cnJlbnRVc2VyID0ge307XG4gICAgZWRpdEFJOiBib29sZWFuO1xuICAgIGVkaXRHSTogYm9vbGVhbjtcbiAgICBlbWFpbEVycm9yOiBib29sZWFuO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcm91dGVyOiBSb3V0ZXIsXG4gICAgICAgIHByaXZhdGUgYXV0aFNlcnZpY2U6IEF1dGhTZXJ2aWNlLFxuICAgICAgICBwcml2YXRlIHNvY2tldDogU29ja2V0U2VydmljZVxuICAgICkgeyB9XG5cbiAgICBnZW5lcmF0ZVRpbWUodW5peCkge1xuICAgICAgICByZXR1cm4gbW9tZW50KHVuaXgpLmZvcm1hdCgnTExMJyk7XG4gICAgfVxuXG4gICAgZ2VuZXJhdGVEYXRlKHVuaXgpIHtcbiAgICAgICAgcmV0dXJuIG1vbWVudCh1bml4KS5mb3JtYXQoJ0xMJyk7XG4gICAgfVxuXG4gICAgZ2V0Q3VycmVudFVzZXIoKSB7XG4gICAgICAgIHRoaXMuYXV0aFNlcnZpY2UuZ2V0Q3VycmVudFVzZXIoSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3VycmVudF91c2VyJykpLl9pZClcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoXG4gICAgICAgICAgICB1c2VyID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh1c2VyKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRVc2VyID0gdXNlclxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmF1dGhTZXJ2aWNlLmxvZ1VzZXJPdXQoKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyg8YW55PmVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9uU3VibWl0KHZhbHVlOiBhbnksIGNhcmROYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgLy8gU2VuZCB1cGRhdGVkIHVzZXIgb2JqZWN0IHRvIGJhY2tlbmRcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5hdXRoU2VydmljZS51cGRhdGVVc2VyKHZhbHVlKVxuICAgICAgICAgICAgLnN1YnNjcmliZShcbiAgICAgICAgICAgICAgICByZXMgPT4gaGFuZGxlUmVzcG9uc2UocmVzKSxcbiAgICAgICAgICAgICAgICBlcnIgPT4gY29uc29sZS5sb2coJ2VyciBAdXBkYXRlVXNlcjogJywgZXJyKVxuICAgICAgICAgICAgKVxuXG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZVJlc3BvbnNlKHJlcykge1xuICAgICAgICAgICAgLy8gQWZ0ZXIgc2F2aW5nIHN1Y2Nlc3NmdWxseSBDbG9zZSB0aGUgc3BlY2lmaWMgY2FyZChmb3JtKVxuICAgICAgICAgICAgc2VsZltjYXJkTmFtZV0gPSAhKHNlbGZbY2FyZE5hbWVdKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGVkaXQoY2FyZE5hbWU6IHN0cmluZykge1xuICAgICAgICB0aGlzW2NhcmROYW1lXSA9ICEodGhpc1tjYXJkTmFtZV0pO1xuICAgIH1cblxuICAgIGNoZWNrUm9sZShyb2xlOiBzdHJpbmcsIHVzZXI6IFVzZXIpIHtcbiAgICAgICAgLy9yb2xlIGlzIHRoZSByZXF1aXJlZCByb2xlIHRvIGFjY2VzcyB0aGUgY29udGVudFxuICAgICAgICAvL1VzZXIncyByb2xlIG11c3QgaGF2ZSBoaWdoZXIgb3IgZXF1YWwgYXV0aG9yaXR5IHRvIHRoaXMgcm9sZVxuICAgICAgICBpZih1c2VyKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hdXRoU2VydmljZS5jaGVja0F1dGhvcml0eShyb2xlLCB1c2VyLnJvbGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYWRkU3R1ZGVudChlbWFpbDogc3RyaW5nKSB7XG4gICAgICAgIGlmKGVtYWlsKSB7XG4gICAgICAgICAgICAvL0ZpbmQgdXNlciBieSBlbWFpbFxuICAgICAgICAgICAgdGhpcy5hdXRoU2VydmljZS5nZXRVc2VyQnlFbWFpbChlbWFpbClcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoXG4gICAgICAgICAgICB1c2VyID0+IHtcbiAgICAgICAgICAgICAgICAvL0FkZCB1c2VyIHRvIHRoaXMgdXNlcidzIHN0dWRlbnRcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvciA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbWFpbEVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBuZ09uSW5pdCgpIHtcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLmN1cnJlbnRVc2VyID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3VycmVudF91c2VyJykpO1xuICAgICAgICB0aGlzLmdldEN1cnJlbnRVc2VyKCk7XG4gICAgICAgIHRoaXMuc29ja2V0LnN5bmNCeUlkKCd1c2VyJywgdGhpcy5jdXJyZW50VXNlci5faWQsIGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgIHNlbGYuY3VycmVudFVzZXIgPSB1c2VyO1xuICAgICAgICB9KTtcbiAgICB9XG59XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
