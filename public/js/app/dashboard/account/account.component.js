"use strict";var __decorate=this&&this.__decorate||function(e,t,r,o){var c,n=arguments.length,i=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var s=e.length-1;s>=0;s--)(c=e[s])&&(i=(n<3?c(i):n>3?c(t,r,i):c(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),router_1=require("@angular/router"),moment=require("moment"),auth_service_1=require("../../shared/services/auth.service"),socket_service_1=require("../../shared/services/socket.service"),AccountComponent=function(){function e(e,t,r){this.router=e,this.authService=t,this.socket=r,this.currentUser={},this.service="student"}return e.prototype.generateTime=function(e){return moment(e).format("LLL")},e.prototype.generateDate=function(e){return moment(e).format("LL")},e.prototype.getCurrentUser=function(){var e=this;this.authService.getCurrentUser(JSON.parse(localStorage.getItem("current_user"))._id).subscribe(function(t){console.log(t),e.currentUser=t},function(t){e.authService.logUserOut(),console.log(t)})},e.prototype.onSubmit=function(e,t){function r(e){o[t]=!o[t]}var o=this;this.authService.updateUser(e).subscribe(function(e){return r(e)},function(e){return console.log("err @updateUser: ",e)})},e.prototype.edit=function(e){this[e]=!this[e]},e.prototype.checkRole=function(e,t){return!!t&&this.authService.checkAuthority(e,t.role)},e.prototype.addStudent=function(e){var t=this;e&&this.authService.getUserByEmail(e).subscribe(function(e){},function(e){t.emailError=!0})},e.prototype.selectService=function(e){console.log("select",e)},e.prototype.ngOnInit=function(){var e=this;this.currentUser=JSON.parse(localStorage.getItem("current_user")),this.getCurrentUser(),this.socket.syncById("user",this.currentUser._id,function(t){e.currentUser=t})},e=__decorate([core_1.Component({moduleId:module.id,selector:"yeah-account",templateUrl:"account.component.html",styleUrls:["account.style.css"],providers:[auth_service_1.AuthService,socket_service_1.SocketService]}),__metadata("design:paramtypes",[router_1.Router,auth_service_1.AuthService,socket_service_1.SocketService])],e)}();exports.AccountComponent=AccountComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRhc2hib2FyZC9hY2NvdW50L2FjY291bnQuY29tcG9uZW50LmpzIiwiZGFzaGJvYXJkL2FjY291bnQvYWNjb3VudC5jb21wb25lbnQudHMiXSwibmFtZXMiOlsiX19kZWNvcmF0ZSIsInRoaXMiLCJkZWNvcmF0b3JzIiwidGFyZ2V0Iiwia2V5IiwiZGVzYyIsImQiLCJjIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiciIsIk9iamVjdCIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsIlJlZmxlY3QiLCJkZWNvcmF0ZSIsImkiLCJkZWZpbmVQcm9wZXJ0eSIsIl9fbWV0YWRhdGEiLCJrIiwidiIsIm1ldGFkYXRhIiwiY29yZV8xIiwicmVxdWlyZSIsInJvdXRlcl8xIiwibW9tZW50IiwiYXV0aF9zZXJ2aWNlXzEiLCJzb2NrZXRfc2VydmljZV8xIiwiQWNjb3VudENvbXBvbmVudCIsInJvdXRlciIsImF1dGhTZXJ2aWNlIiwic29ja2V0IiwiY3VycmVudFVzZXIiLCJzZXJ2aWNlIiwicHJvdG90eXBlIiwiZ2VuZXJhdGVUaW1lIiwidW5peCIsImZvcm1hdCIsImdlbmVyYXRlRGF0ZSIsImdldEN1cnJlbnRVc2VyIiwiX3RoaXMiLCJKU09OIiwicGFyc2UiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiX2lkIiwic3Vic2NyaWJlIiwidXNlciIsImNvbnNvbGUiLCJsb2ciLCJlcnJvciIsImxvZ1VzZXJPdXQiLCJvblN1Ym1pdCIsInZhbHVlIiwiY2FyZE5hbWUiLCJoYW5kbGVSZXNwb25zZSIsInJlcyIsInNlbGYiLCJ1cGRhdGVVc2VyIiwiZXJyIiwiZWRpdCIsImNoZWNrUm9sZSIsInJvbGUiLCJjaGVja0F1dGhvcml0eSIsImFkZFN0dWRlbnQiLCJlbWFpbCIsImdldFVzZXJCeUVtYWlsIiwiZW1haWxFcnJvciIsInNlbGVjdFNlcnZpY2UiLCJuZ09uSW5pdCIsInN5bmNCeUlkIiwiQ29tcG9uZW50IiwibW9kdWxlSWQiLCJtb2R1bGUiLCJpZCIsInNlbGVjdG9yIiwidGVtcGxhdGVVcmwiLCJzdHlsZVVybHMiLCJwcm92aWRlcnMiLCJBdXRoU2VydmljZSIsIlNvY2tldFNlcnZpY2UiLCJSb3V0ZXIiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUNBLElBQUlBLFlBQWNDLE1BQVFBLEtBQUtELFlBQWUsU0FBVUUsRUFBWUMsRUFBUUMsRUFBS0MsR0FDN0UsR0FBMkhDLEdBQXZIQyxFQUFJQyxVQUFVQyxPQUFRQyxFQUFJSCxFQUFJLEVBQUlKLEVBQWtCLE9BQVRFLEVBQWdCQSxFQUFPTSxPQUFPQyx5QkFBeUJULEVBQVFDLEdBQU9DLENBQ3JILElBQXVCLGdCQUFaUSxVQUFvRCxrQkFBckJBLFNBQVFDLFNBQXlCSixFQUFJRyxRQUFRQyxTQUFTWixFQUFZQyxFQUFRQyxFQUFLQyxPQUNwSCxLQUFLLEdBQUlVLEdBQUliLEVBQVdPLE9BQVMsRUFBR00sR0FBSyxFQUFHQSxLQUFTVCxFQUFJSixFQUFXYSxNQUFJTCxHQUFLSCxFQUFJLEVBQUlELEVBQUVJLEdBQUtILEVBQUksRUFBSUQsRUFBRUgsRUFBUUMsRUFBS00sR0FBS0osRUFBRUgsRUFBUUMsS0FBU00sRUFDaEosT0FBT0gsR0FBSSxHQUFLRyxHQUFLQyxPQUFPSyxlQUFlYixFQUFRQyxFQUFLTSxHQUFJQSxHQUU1RE8sV0FBY2hCLE1BQVFBLEtBQUtnQixZQUFlLFNBQVVDLEVBQUdDLEdBQ3ZELEdBQXVCLGdCQUFaTixVQUFvRCxrQkFBckJBLFNBQVFPLFNBQXlCLE1BQU9QLFNBQVFPLFNBQVNGLEVBQUdDLElDUjFHRSxPQUFBQyxRQUE2QyxpQkFDN0NDLFNBQUFELFFBQTBCLG1CQUNuQkUsT0FBTUYsUUFBVyxVQUd4QkcsZUFBQUgsUUFBNEIsc0NBQzVCSSxpQkFBQUosUUFBOEIsd0NBVTlCSyxpQkFBQSxXQU9JLFFBQUFBLEdBQ1lDLEVBQ0FDLEVBQ0FDLEdBRkE3QixLQUFBMkIsT0FBQUEsRUFDQTNCLEtBQUE0QixZQUFBQSxFQUNBNUIsS0FBQTZCLE9BQUFBLEVBVFo3QixLQUFBOEIsZUFJQTlCLEtBQUErQixRQUFVLFVBeUZkLE1BakZJTCxHQUFBTSxVQUFBQyxhQUFBLFNBQWFDLEdBQ1QsTUFBT1gsUUFBT1csR0FBTUMsT0FBTyxRQUcvQlQsRUFBQU0sVUFBQUksYUFBQSxTQUFhRixHQUNULE1BQU9YLFFBQU9XLEdBQU1DLE9BQU8sT0FHL0JULEVBQUFNLFVBQUFLLGVBQUEsV0FBQSxHQUFBQyxHQUFBdEMsSUFDSUEsTUFBSzRCLFlBQVlTLGVBQWVFLEtBQUtDLE1BQU1DLGFBQWFDLFFBQVEsaUJBQWlCQyxLQUM1RUMsVUFDRCxTQUFBQyxHQUNJQyxRQUFRQyxJQUFJRixHQUVaUCxFQUFLUixZQUFjZSxHQUV2QixTQUFBRyxHQUNJVixFQUFLVixZQUFZcUIsYUFDakJILFFBQVFDLElBQVNDLE1BSTdCdEIsRUFBQU0sVUFBQWtCLFNBQUEsU0FBU0MsRUFBWUMsR0FVakIsUUFBQUMsR0FBd0JDLEdBRXBCQyxFQUFLSCxJQUFjRyxFQUFLSCxHQVY1QixHQUFJRyxHQUFPdkQsSUFFWEEsTUFBSzRCLFlBQVk0QixXQUFXTCxHQUN2QlAsVUFDRyxTQUFBVSxHQUFPLE1BQUFELEdBQWVDLElBQ3RCLFNBQUFHLEdBQU8sTUFBQVgsU0FBUUMsSUFBSSxvQkFBcUJVLE1BU3BEL0IsRUFBQU0sVUFBQTBCLEtBQUEsU0FBS04sR0FDRHBELEtBQUtvRCxJQUFjcEQsS0FBS29ELElBRzVCMUIsRUFBQU0sVUFBQTJCLFVBQUEsU0FBVUMsRUFBY2YsR0FHcEIsUUFBR0EsR0FDUTdDLEtBQUs0QixZQUFZaUMsZUFBZUQsRUFBTWYsRUFBS2UsT0FNMURsQyxFQUFBTSxVQUFBOEIsV0FBQSxTQUFXQyxHQUFYLEdBQUF6QixHQUFBdEMsSUFDTytELElBRUMvRCxLQUFLNEIsWUFBWW9DLGVBQWVELEdBQy9CbkIsVUFDRCxTQUFBQyxLQUlBLFNBQUFHLEdBQ0lWLEVBQUsyQixZQUFhLEtBTTlCdkMsRUFBQU0sVUFBQWtDLGNBQUEsU0FBY25DLEdBQ1ZlLFFBQVFDLElBQUksU0FBVWhCLElBRzFCTCxFQUFBTSxVQUFBbUMsU0FBQSxXQUNJLEdBQUlaLEdBQU92RCxJQUNYQSxNQUFLOEIsWUFBY1MsS0FBS0MsTUFBTUMsYUFBYUMsUUFBUSxpQkFDbkQxQyxLQUFLcUMsaUJBQ0xyQyxLQUFLNkIsT0FBT3VDLFNBQVMsT0FBUXBFLEtBQUs4QixZQUFZYSxJQUFLLFNBQVNFLEdBQ3hEVSxFQUFLekIsWUFBY2UsS0FsRy9CbkIsRUFBQTNCLFlBQUNxQixPQUFBaUQsV0FDR0MsU0FBVUMsT0FBT0MsR0FDakJDLFNBQVUsZUFDVkMsWUFBYSx5QkFDYkMsV0FBWSxxQkFDWkMsV0FBWXBELGVBQUFxRCxZQUFhcEQsaUJBQUFxRCxpQkRpRnJCOUQsV0FBVyxxQkFBc0JNLFNBQVN5RCxPQUFRdkQsZUFBZXFELFlBQWFwRCxpQkFBaUJxRCxpQkFDaEdwRCxLQy9FTXNELFNBQUF0RCxpQkFBZ0JBIiwiZmlsZSI6ImRhc2hib2FyZC9hY2NvdW50L2FjY291bnQuY29tcG9uZW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG52YXIgX19tZXRhZGF0YSA9ICh0aGlzICYmIHRoaXMuX19tZXRhZGF0YSkgfHwgZnVuY3Rpb24gKGssIHYpIHtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEoaywgdik7XG59O1xudmFyIGNvcmVfMSA9IHJlcXVpcmUoJ0Bhbmd1bGFyL2NvcmUnKTtcbnZhciByb3V0ZXJfMSA9IHJlcXVpcmUoJ0Bhbmd1bGFyL3JvdXRlcicpO1xudmFyIG1vbWVudCA9IHJlcXVpcmUoJ21vbWVudCcpO1xudmFyIGF1dGhfc2VydmljZV8xID0gcmVxdWlyZSgnLi4vLi4vc2hhcmVkL3NlcnZpY2VzL2F1dGguc2VydmljZScpO1xudmFyIHNvY2tldF9zZXJ2aWNlXzEgPSByZXF1aXJlKCcuLi8uLi9zaGFyZWQvc2VydmljZXMvc29ja2V0LnNlcnZpY2UnKTtcbnZhciBBY2NvdW50Q29tcG9uZW50ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBBY2NvdW50Q29tcG9uZW50KHJvdXRlciwgYXV0aFNlcnZpY2UsIHNvY2tldCkge1xuICAgICAgICB0aGlzLnJvdXRlciA9IHJvdXRlcjtcbiAgICAgICAgdGhpcy5hdXRoU2VydmljZSA9IGF1dGhTZXJ2aWNlO1xuICAgICAgICB0aGlzLnNvY2tldCA9IHNvY2tldDtcbiAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IHt9O1xuICAgICAgICB0aGlzLnNlcnZpY2UgPSAnc3R1ZGVudCc7XG4gICAgfVxuICAgIEFjY291bnRDb21wb25lbnQucHJvdG90eXBlLmdlbmVyYXRlVGltZSA9IGZ1bmN0aW9uICh1bml4KSB7XG4gICAgICAgIHJldHVybiBtb21lbnQodW5peCkuZm9ybWF0KCdMTEwnKTtcbiAgICB9O1xuICAgIEFjY291bnRDb21wb25lbnQucHJvdG90eXBlLmdlbmVyYXRlRGF0ZSA9IGZ1bmN0aW9uICh1bml4KSB7XG4gICAgICAgIHJldHVybiBtb21lbnQodW5peCkuZm9ybWF0KCdMTCcpO1xuICAgIH07XG4gICAgQWNjb3VudENvbXBvbmVudC5wcm90b3R5cGUuZ2V0Q3VycmVudFVzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuYXV0aFNlcnZpY2UuZ2V0Q3VycmVudFVzZXIoSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3VycmVudF91c2VyJykpLl9pZClcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHVzZXIpO1xuICAgICAgICAgICAgX3RoaXMuY3VycmVudFVzZXIgPSB1c2VyO1xuICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgIF90aGlzLmF1dGhTZXJ2aWNlLmxvZ1VzZXJPdXQoKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBBY2NvdW50Q29tcG9uZW50LnByb3RvdHlwZS5vblN1Ym1pdCA9IGZ1bmN0aW9uICh2YWx1ZSwgY2FyZE5hbWUpIHtcbiAgICAgICAgLy8gU2VuZCB1cGRhdGVkIHVzZXIgb2JqZWN0IHRvIGJhY2tlbmRcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLmF1dGhTZXJ2aWNlLnVwZGF0ZVVzZXIodmFsdWUpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKGZ1bmN0aW9uIChyZXMpIHsgcmV0dXJuIGhhbmRsZVJlc3BvbnNlKHJlcyk7IH0sIGZ1bmN0aW9uIChlcnIpIHsgcmV0dXJuIGNvbnNvbGUubG9nKCdlcnIgQHVwZGF0ZVVzZXI6ICcsIGVycik7IH0pO1xuICAgICAgICBmdW5jdGlvbiBoYW5kbGVSZXNwb25zZShyZXMpIHtcbiAgICAgICAgICAgIC8vIEFmdGVyIHNhdmluZyBzdWNjZXNzZnVsbHkgQ2xvc2UgdGhlIHNwZWNpZmljIGNhcmQoZm9ybSlcbiAgICAgICAgICAgIHNlbGZbY2FyZE5hbWVdID0gIShzZWxmW2NhcmROYW1lXSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjY291bnRDb21wb25lbnQucHJvdG90eXBlLmVkaXQgPSBmdW5jdGlvbiAoY2FyZE5hbWUpIHtcbiAgICAgICAgdGhpc1tjYXJkTmFtZV0gPSAhKHRoaXNbY2FyZE5hbWVdKTtcbiAgICB9O1xuICAgIEFjY291bnRDb21wb25lbnQucHJvdG90eXBlLmNoZWNrUm9sZSA9IGZ1bmN0aW9uIChyb2xlLCB1c2VyKSB7XG4gICAgICAgIC8vcm9sZSBpcyB0aGUgcmVxdWlyZWQgcm9sZSB0byBhY2Nlc3MgdGhlIGNvbnRlbnRcbiAgICAgICAgLy9Vc2VyJ3Mgcm9sZSBtdXN0IGhhdmUgaGlnaGVyIG9yIGVxdWFsIGF1dGhvcml0eSB0byB0aGlzIHJvbGVcbiAgICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmF1dGhTZXJ2aWNlLmNoZWNrQXV0aG9yaXR5KHJvbGUsIHVzZXIucm9sZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIEFjY291bnRDb21wb25lbnQucHJvdG90eXBlLmFkZFN0dWRlbnQgPSBmdW5jdGlvbiAoZW1haWwpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKGVtYWlsKSB7XG4gICAgICAgICAgICAvL0ZpbmQgdXNlciBieSBlbWFpbFxuICAgICAgICAgICAgdGhpcy5hdXRoU2VydmljZS5nZXRVc2VyQnlFbWFpbChlbWFpbClcbiAgICAgICAgICAgICAgICAuc3Vic2NyaWJlKGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgICAgICAgICAgLy9BZGQgdXNlciB0byB0aGlzIHVzZXIncyBzdHVkZW50XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5lbWFpbEVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBBY2NvdW50Q29tcG9uZW50LnByb3RvdHlwZS5zZWxlY3RTZXJ2aWNlID0gZnVuY3Rpb24gKHNlcnZpY2UpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ3NlbGVjdCcsIHNlcnZpY2UpO1xuICAgIH07XG4gICAgQWNjb3VudENvbXBvbmVudC5wcm90b3R5cGUubmdPbkluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2N1cnJlbnRfdXNlcicpKTtcbiAgICAgICAgdGhpcy5nZXRDdXJyZW50VXNlcigpO1xuICAgICAgICB0aGlzLnNvY2tldC5zeW5jQnlJZCgndXNlcicsIHRoaXMuY3VycmVudFVzZXIuX2lkLCBmdW5jdGlvbiAodXNlcikge1xuICAgICAgICAgICAgc2VsZi5jdXJyZW50VXNlciA9IHVzZXI7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQWNjb3VudENvbXBvbmVudCA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBjb3JlXzEuQ29tcG9uZW50KHtcbiAgICAgICAgICAgIG1vZHVsZUlkOiBtb2R1bGUuaWQsXG4gICAgICAgICAgICBzZWxlY3RvcjogJ3llYWgtYWNjb3VudCcsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FjY291bnQuY29tcG9uZW50Lmh0bWwnLFxuICAgICAgICAgICAgc3R5bGVVcmxzOiBbJ2FjY291bnQuc3R5bGUuY3NzJ10sXG4gICAgICAgICAgICBwcm92aWRlcnM6IFthdXRoX3NlcnZpY2VfMS5BdXRoU2VydmljZSwgc29ja2V0X3NlcnZpY2VfMS5Tb2NrZXRTZXJ2aWNlXVxuICAgICAgICB9KSwgXG4gICAgICAgIF9fbWV0YWRhdGEoJ2Rlc2lnbjpwYXJhbXR5cGVzJywgW3JvdXRlcl8xLlJvdXRlciwgYXV0aF9zZXJ2aWNlXzEuQXV0aFNlcnZpY2UsIHNvY2tldF9zZXJ2aWNlXzEuU29ja2V0U2VydmljZV0pXG4gICAgXSwgQWNjb3VudENvbXBvbmVudCk7XG4gICAgcmV0dXJuIEFjY291bnRDb21wb25lbnQ7XG59KCkpO1xuZXhwb3J0cy5BY2NvdW50Q29tcG9uZW50ID0gQWNjb3VudENvbXBvbmVudDtcbiIsImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBPbkRlc3Ryb3kgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFJvdXRlciB9ICAgIGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XG5pbXBvcnQgbW9tZW50ID0gcmVxdWlyZSgnbW9tZW50Jyk7XG5cbmltcG9ydCB7IFVzZXIgfSBmcm9tICcuLi8uLi9zaGFyZWQvdHlwZXMvdXNlcidcbmltcG9ydCB7IEF1dGhTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2hhcmVkL3NlcnZpY2VzL2F1dGguc2VydmljZSc7XG5pbXBvcnQgeyBTb2NrZXRTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2hhcmVkL3NlcnZpY2VzL3NvY2tldC5zZXJ2aWNlJztcblxuQENvbXBvbmVudCh7XG4gICAgbW9kdWxlSWQ6IG1vZHVsZS5pZCxcbiAgICBzZWxlY3RvcjogJ3llYWgtYWNjb3VudCcsXG4gICAgdGVtcGxhdGVVcmw6ICdhY2NvdW50LmNvbXBvbmVudC5odG1sJyxcbiAgICBzdHlsZVVybHM6IFsnYWNjb3VudC5zdHlsZS5jc3MnXSxcbiAgICBwcm92aWRlcnM6IFtBdXRoU2VydmljZSwgU29ja2V0U2VydmljZV1cbn0pXG5cbmV4cG9ydCBjbGFzcyBBY2NvdW50Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgICBjdXJyZW50VXNlciA9IHt9O1xuICAgIGVkaXRBSTogYm9vbGVhbjtcbiAgICBlZGl0R0k6IGJvb2xlYW47XG4gICAgZW1haWxFcnJvcjogYm9vbGVhbjtcbiAgICBzZXJ2aWNlID0gJ3N0dWRlbnQnO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgcm91dGVyOiBSb3V0ZXIsXG4gICAgICAgIHByaXZhdGUgYXV0aFNlcnZpY2U6IEF1dGhTZXJ2aWNlLFxuICAgICAgICBwcml2YXRlIHNvY2tldDogU29ja2V0U2VydmljZVxuICAgICkgeyB9XG5cbiAgICBnZW5lcmF0ZVRpbWUodW5peCkge1xuICAgICAgICByZXR1cm4gbW9tZW50KHVuaXgpLmZvcm1hdCgnTExMJyk7XG4gICAgfVxuXG4gICAgZ2VuZXJhdGVEYXRlKHVuaXgpIHtcbiAgICAgICAgcmV0dXJuIG1vbWVudCh1bml4KS5mb3JtYXQoJ0xMJyk7XG4gICAgfVxuXG4gICAgZ2V0Q3VycmVudFVzZXIoKSB7XG4gICAgICAgIHRoaXMuYXV0aFNlcnZpY2UuZ2V0Q3VycmVudFVzZXIoSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3VycmVudF91c2VyJykpLl9pZClcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoXG4gICAgICAgICAgICB1c2VyID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh1c2VyKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRVc2VyID0gdXNlclxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmF1dGhTZXJ2aWNlLmxvZ1VzZXJPdXQoKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyg8YW55PmVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIG9uU3VibWl0KHZhbHVlOiBhbnksIGNhcmROYW1lOiBzdHJpbmcpIHtcbiAgICAgICAgLy8gU2VuZCB1cGRhdGVkIHVzZXIgb2JqZWN0IHRvIGJhY2tlbmRcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5hdXRoU2VydmljZS51cGRhdGVVc2VyKHZhbHVlKVxuICAgICAgICAgICAgLnN1YnNjcmliZShcbiAgICAgICAgICAgICAgICByZXMgPT4gaGFuZGxlUmVzcG9uc2UocmVzKSxcbiAgICAgICAgICAgICAgICBlcnIgPT4gY29uc29sZS5sb2coJ2VyciBAdXBkYXRlVXNlcjogJywgZXJyKVxuICAgICAgICAgICAgKVxuXG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZVJlc3BvbnNlKHJlcykge1xuICAgICAgICAgICAgLy8gQWZ0ZXIgc2F2aW5nIHN1Y2Nlc3NmdWxseSBDbG9zZSB0aGUgc3BlY2lmaWMgY2FyZChmb3JtKVxuICAgICAgICAgICAgc2VsZltjYXJkTmFtZV0gPSAhKHNlbGZbY2FyZE5hbWVdKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGVkaXQoY2FyZE5hbWU6IHN0cmluZykge1xuICAgICAgICB0aGlzW2NhcmROYW1lXSA9ICEodGhpc1tjYXJkTmFtZV0pO1xuICAgIH1cblxuICAgIGNoZWNrUm9sZShyb2xlOiBzdHJpbmcsIHVzZXI6IFVzZXIpIHtcbiAgICAgICAgLy9yb2xlIGlzIHRoZSByZXF1aXJlZCByb2xlIHRvIGFjY2VzcyB0aGUgY29udGVudFxuICAgICAgICAvL1VzZXIncyByb2xlIG11c3QgaGF2ZSBoaWdoZXIgb3IgZXF1YWwgYXV0aG9yaXR5IHRvIHRoaXMgcm9sZVxuICAgICAgICBpZih1c2VyKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hdXRoU2VydmljZS5jaGVja0F1dGhvcml0eShyb2xlLCB1c2VyLnJvbGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYWRkU3R1ZGVudChlbWFpbDogc3RyaW5nKSB7XG4gICAgICAgIGlmKGVtYWlsKSB7XG4gICAgICAgICAgICAvL0ZpbmQgdXNlciBieSBlbWFpbFxuICAgICAgICAgICAgdGhpcy5hdXRoU2VydmljZS5nZXRVc2VyQnlFbWFpbChlbWFpbClcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoXG4gICAgICAgICAgICB1c2VyID0+IHtcbiAgICAgICAgICAgICAgICAvL0FkZCB1c2VyIHRvIHRoaXMgdXNlcidzIHN0dWRlbnRcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvciA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbWFpbEVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzZWxlY3RTZXJ2aWNlKHNlcnZpY2U6IHN0cmluZykge1xuICAgICAgICBjb25zb2xlLmxvZygnc2VsZWN0Jywgc2VydmljZSk7XG4gICAgfVxuXG4gICAgbmdPbkluaXQoKSB7XG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2N1cnJlbnRfdXNlcicpKTtcbiAgICAgICAgdGhpcy5nZXRDdXJyZW50VXNlcigpO1xuICAgICAgICB0aGlzLnNvY2tldC5zeW5jQnlJZCgndXNlcicsIHRoaXMuY3VycmVudFVzZXIuX2lkLCBmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgICBzZWxmLmN1cnJlbnRVc2VyID0gdXNlcjtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
