"use strict";var __decorate=this&&this.__decorate||function(e,t,r,o){var c,n=arguments.length,i=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,o);else for(var u=e.length-1;u>=0;u--)(c=e[u])&&(i=(n<3?c(i):n>3?c(t,r,i):c(t,r))||i);return n>3&&i&&Object.defineProperty(t,r,i),i},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),router_1=require("@angular/router"),moment=require("moment"),auth_service_1=require("../../shared/services/auth.service"),socket_service_1=require("../../shared/services/socket.service"),AccountComponent=function(){function e(e,t,r){this.router=e,this.authService=t,this.socket=r,this.currentUser={}}return e.prototype.generateTime=function(e){return moment(e).format("LLL")},e.prototype.generateDate=function(e){return moment(e).format("LL")},e.prototype.getCurrentUser=function(){var e=this;this.authService.getCurrentUser(JSON.parse(localStorage.getItem("current_user"))._id).subscribe(function(t){console.log(t),e.currentUser=t},function(t){e.authService.logUserOut(),console.log(t)})},e.prototype.onSubmit=function(e,t){function r(e){o[t]=!o[t]}var o=this;this.authService.updateUser(e).subscribe(function(e){return r(e)},function(e){return console.log("err @updateUser: ",e)})},e.prototype.edit=function(e){this[e]=!this[e]},e.prototype.checkRole=function(e,t){return!!t&&this.authService.checkAuthority(e,t.role)},e.prototype.ngOnInit=function(){var e=this;this.currentUser=JSON.parse(localStorage.getItem("current_user")),this.getCurrentUser(),this.socket.syncById("user",this.currentUser._id,function(t){e.currentUser=t})},e=__decorate([core_1.Component({moduleId:module.id,selector:"yeah-account",templateUrl:"account.component.html",styleUrls:["account.style.css"],providers:[auth_service_1.AuthService,socket_service_1.SocketService]}),__metadata("design:paramtypes",[router_1.Router,auth_service_1.AuthService,socket_service_1.SocketService])],e)}();exports.AccountComponent=AccountComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRhc2hib2FyZC9hY2NvdW50L2FjY291bnQuY29tcG9uZW50LmpzIiwiZGFzaGJvYXJkL2FjY291bnQvYWNjb3VudC5jb21wb25lbnQudHMiXSwibmFtZXMiOlsiX19kZWNvcmF0ZSIsInRoaXMiLCJkZWNvcmF0b3JzIiwidGFyZ2V0Iiwia2V5IiwiZGVzYyIsImQiLCJjIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiciIsIk9iamVjdCIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsIlJlZmxlY3QiLCJkZWNvcmF0ZSIsImkiLCJkZWZpbmVQcm9wZXJ0eSIsIl9fbWV0YWRhdGEiLCJrIiwidiIsIm1ldGFkYXRhIiwiY29yZV8xIiwicmVxdWlyZSIsInJvdXRlcl8xIiwibW9tZW50IiwiYXV0aF9zZXJ2aWNlXzEiLCJzb2NrZXRfc2VydmljZV8xIiwiQWNjb3VudENvbXBvbmVudCIsInJvdXRlciIsImF1dGhTZXJ2aWNlIiwic29ja2V0IiwiY3VycmVudFVzZXIiLCJwcm90b3R5cGUiLCJnZW5lcmF0ZVRpbWUiLCJ1bml4IiwiZm9ybWF0IiwiZ2VuZXJhdGVEYXRlIiwiZ2V0Q3VycmVudFVzZXIiLCJfdGhpcyIsIkpTT04iLCJwYXJzZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJfaWQiLCJzdWJzY3JpYmUiLCJ1c2VyIiwiY29uc29sZSIsImxvZyIsImVycm9yIiwibG9nVXNlck91dCIsIm9uU3VibWl0IiwidmFsdWUiLCJjYXJkTmFtZSIsImhhbmRsZVJlc3BvbnNlIiwicmVzIiwic2VsZiIsInVwZGF0ZVVzZXIiLCJlcnIiLCJlZGl0IiwiY2hlY2tSb2xlIiwicm9sZSIsImNoZWNrQXV0aG9yaXR5IiwibmdPbkluaXQiLCJzeW5jQnlJZCIsIkNvbXBvbmVudCIsIm1vZHVsZUlkIiwibW9kdWxlIiwiaWQiLCJzZWxlY3RvciIsInRlbXBsYXRlVXJsIiwic3R5bGVVcmxzIiwicHJvdmlkZXJzIiwiQXV0aFNlcnZpY2UiLCJTb2NrZXRTZXJ2aWNlIiwi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QyxpQkRpRXJCeEQsV0FBVyxxQkFBc0JNLFNBQVNtRCxPQUFRakQsZUFBZStDLFlBQWE5QyxpQkFBaUIrQyxpQkFDaEc5QyxLQ2hFTWdELFNBQUFoRCxpQkFBZ0JBIiwiZmlsZSI6ImRhc2hib2FyZC9hY2NvdW50L2FjY291bnQuY29tcG9uZW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG52YXIgX19tZXRhZGF0YSA9ICh0aGlzICYmIHRoaXMuX19tZXRhZGF0YSkgfHwgZnVuY3Rpb24gKGssIHYpIHtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEoaywgdik7XG59O1xudmFyIGNvcmVfMSA9IHJlcXVpcmUoJ0Bhbmd1bGFyL2NvcmUnKTtcbnZhciByb3V0ZXJfMSA9IHJlcXVpcmUoJ0Bhbmd1bGFyL3JvdXRlcicpO1xudmFyIG1vbWVudCA9IHJlcXVpcmUoJ21vbWVudCcpO1xudmFyIGF1dGhfc2VydmljZV8xID0gcmVxdWlyZSgnLi4vLi4vc2hhcmVkL3NlcnZpY2VzL2F1dGguc2VydmljZScpO1xudmFyIHNvY2tldF9zZXJ2aWNlXzEgPSByZXF1aXJlKCcuLi8uLi9zaGFyZWQvc2VydmljZXMvc29ja2V0LnNlcnZpY2UnKTtcbnZhciBBY2NvdW50Q29tcG9uZW50ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBBY2NvdW50Q29tcG9uZW50KHJvdXRlciwgYXV0aFNlcnZpY2UsIHNvY2tldCkge1xuICAgICAgICB0aGlzLnJvdXRlciA9IHJvdXRlcjtcbiAgICAgICAgdGhpcy5hdXRoU2VydmljZSA9IGF1dGhTZXJ2aWNlO1xuICAgICAgICB0aGlzLnNvY2tldCA9IHNvY2tldDtcbiAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IHt9O1xuICAgIH1cbiAgICBBY2NvdW50Q29tcG9uZW50LnByb3RvdHlwZS5nZW5lcmF0ZVRpbWUgPSBmdW5jdGlvbiAodW5peCkge1xuICAgICAgICByZXR1cm4gbW9tZW50KHVuaXgpLmZvcm1hdCgnTExMJyk7XG4gICAgfTtcbiAgICBBY2NvdW50Q29tcG9uZW50LnByb3RvdHlwZS5nZW5lcmF0ZURhdGUgPSBmdW5jdGlvbiAodW5peCkge1xuICAgICAgICByZXR1cm4gbW9tZW50KHVuaXgpLmZvcm1hdCgnTEwnKTtcbiAgICB9O1xuICAgIEFjY291bnRDb21wb25lbnQucHJvdG90eXBlLmdldEN1cnJlbnRVc2VyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLmF1dGhTZXJ2aWNlLmdldEN1cnJlbnRVc2VyKEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2N1cnJlbnRfdXNlcicpKS5faWQpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyh1c2VyKTtcbiAgICAgICAgICAgIF90aGlzLmN1cnJlbnRVc2VyID0gdXNlcjtcbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICBfdGhpcy5hdXRoU2VydmljZS5sb2dVc2VyT3V0KCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgQWNjb3VudENvbXBvbmVudC5wcm90b3R5cGUub25TdWJtaXQgPSBmdW5jdGlvbiAodmFsdWUsIGNhcmROYW1lKSB7XG4gICAgICAgIC8vIFNlbmQgdXBkYXRlZCB1c2VyIG9iamVjdCB0byBiYWNrZW5kXG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5hdXRoU2VydmljZS51cGRhdGVVc2VyKHZhbHVlKVxuICAgICAgICAgICAgLnN1YnNjcmliZShmdW5jdGlvbiAocmVzKSB7IHJldHVybiBoYW5kbGVSZXNwb25zZShyZXMpOyB9LCBmdW5jdGlvbiAoZXJyKSB7IHJldHVybiBjb25zb2xlLmxvZygnZXJyIEB1cGRhdGVVc2VyOiAnLCBlcnIpOyB9KTtcbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlUmVzcG9uc2UocmVzKSB7XG4gICAgICAgICAgICAvLyBBZnRlciBzYXZpbmcgc3VjY2Vzc2Z1bGx5IENsb3NlIHRoZSBzcGVjaWZpYyBjYXJkKGZvcm0pXG4gICAgICAgICAgICBzZWxmW2NhcmROYW1lXSA9ICEoc2VsZltjYXJkTmFtZV0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBBY2NvdW50Q29tcG9uZW50LnByb3RvdHlwZS5lZGl0ID0gZnVuY3Rpb24gKGNhcmROYW1lKSB7XG4gICAgICAgIHRoaXNbY2FyZE5hbWVdID0gISh0aGlzW2NhcmROYW1lXSk7XG4gICAgfTtcbiAgICBBY2NvdW50Q29tcG9uZW50LnByb3RvdHlwZS5jaGVja1JvbGUgPSBmdW5jdGlvbiAocm9sZSwgdXNlcikge1xuICAgICAgICAvL3JvbGUgaXMgdGhlIHJlcXVpcmVkIHJvbGUgdG8gYWNjZXNzIHRoZSBjb250ZW50XG4gICAgICAgIC8vVXNlcidzIHJvbGUgbXVzdCBoYXZlIGhpZ2hlciBvciBlcXVhbCBhdXRob3JpdHkgdG8gdGhpcyByb2xlXG4gICAgICAgIGlmICh1c2VyKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5hdXRoU2VydmljZS5jaGVja0F1dGhvcml0eShyb2xlLCB1c2VyLnJvbGUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBBY2NvdW50Q29tcG9uZW50LnByb3RvdHlwZS5uZ09uSW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLmN1cnJlbnRVc2VyID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3VycmVudF91c2VyJykpO1xuICAgICAgICB0aGlzLmdldEN1cnJlbnRVc2VyKCk7XG4gICAgICAgIHRoaXMuc29ja2V0LnN5bmNCeUlkKCd1c2VyJywgdGhpcy5jdXJyZW50VXNlci5faWQsIGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgICAgICBzZWxmLmN1cnJlbnRVc2VyID0gdXNlcjtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBBY2NvdW50Q29tcG9uZW50ID0gX19kZWNvcmF0ZShbXG4gICAgICAgIGNvcmVfMS5Db21wb25lbnQoe1xuICAgICAgICAgICAgbW9kdWxlSWQ6IG1vZHVsZS5pZCxcbiAgICAgICAgICAgIHNlbGVjdG9yOiAneWVhaC1hY2NvdW50JyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYWNjb3VudC5jb21wb25lbnQuaHRtbCcsXG4gICAgICAgICAgICBzdHlsZVVybHM6IFsnYWNjb3VudC5zdHlsZS5jc3MnXSxcbiAgICAgICAgICAgIHByb3ZpZGVyczogW2F1dGhfc2VydmljZV8xLkF1dGhTZXJ2aWNlLCBzb2NrZXRfc2VydmljZV8xLlNvY2tldFNlcnZpY2VdXG4gICAgICAgIH0pLCBcbiAgICAgICAgX19tZXRhZGF0YSgnZGVzaWduOnBhcmFtdHlwZXMnLCBbcm91dGVyXzEuUm91dGVyLCBhdXRoX3NlcnZpY2VfMS5BdXRoU2VydmljZSwgc29ja2V0X3NlcnZpY2VfMS5Tb2NrZXRTZXJ2aWNlXSlcbiAgICBdLCBBY2NvdW50Q29tcG9uZW50KTtcbiAgICByZXR1cm4gQWNjb3VudENvbXBvbmVudDtcbn0oKSk7XG5leHBvcnRzLkFjY291bnRDb21wb25lbnQgPSBBY2NvdW50Q29tcG9uZW50O1xuIiwiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQsIE9uRGVzdHJveSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgUm91dGVyIH0gICAgZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcbmltcG9ydCBtb21lbnQgPSByZXF1aXJlKCdtb21lbnQnKTtcblxuaW1wb3J0IHsgVXNlciB9IGZyb20gJy4uLy4uL3NoYXJlZC90eXBlcy91c2VyJ1xuaW1wb3J0IHsgQXV0aFNlcnZpY2UgfSBmcm9tICcuLi8uLi9zaGFyZWQvc2VydmljZXMvYXV0aC5zZXJ2aWNlJztcbmltcG9ydCB7IFNvY2tldFNlcnZpY2UgfSBmcm9tICcuLi8uLi9zaGFyZWQvc2VydmljZXMvc29ja2V0LnNlcnZpY2UnO1xuXG5AQ29tcG9uZW50KHtcbiAgICBtb2R1bGVJZDogbW9kdWxlLmlkLFxuICAgIHNlbGVjdG9yOiAneWVhaC1hY2NvdW50JyxcbiAgICB0ZW1wbGF0ZVVybDogJ2FjY291bnQuY29tcG9uZW50Lmh0bWwnLFxuICAgIHN0eWxlVXJsczogWydhY2NvdW50LnN0eWxlLmNzcyddLFxuICAgIHByb3ZpZGVyczogW0F1dGhTZXJ2aWNlLCBTb2NrZXRTZXJ2aWNlXVxufSlcbmV4cG9ydCBjbGFzcyBBY2NvdW50Q29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgICBjdXJyZW50VXNlciA9IHt9O1xuICAgIGVkaXRBSTogYm9vbGVhbjtcbiAgICBlZGl0R0k6IGJvb2xlYW47XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSByb3V0ZXI6IFJvdXRlcixcbiAgICAgICAgcHJpdmF0ZSBhdXRoU2VydmljZTogQXV0aFNlcnZpY2UsXG4gICAgICAgIHByaXZhdGUgc29ja2V0OiBTb2NrZXRTZXJ2aWNlXG4gICAgKSB7IH1cblxuICAgIGdlbmVyYXRlVGltZSh1bml4KSB7XG4gICAgICAgIHJldHVybiBtb21lbnQodW5peCkuZm9ybWF0KCdMTEwnKTtcbiAgICB9XG5cbiAgICBnZW5lcmF0ZURhdGUodW5peCkge1xuICAgICAgICByZXR1cm4gbW9tZW50KHVuaXgpLmZvcm1hdCgnTEwnKTtcbiAgICB9XG5cbiAgICBnZXRDdXJyZW50VXNlcigpIHtcbiAgICAgICAgdGhpcy5hdXRoU2VydmljZS5nZXRDdXJyZW50VXNlcihKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjdXJyZW50X3VzZXInKSkuX2lkKVxuICAgICAgICAgICAgLnN1YnNjcmliZShcbiAgICAgICAgICAgIHVzZXIgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHVzZXIpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFVzZXIgPSB1c2VyXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3IgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXV0aFNlcnZpY2UubG9nVXNlck91dCgpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKDxhbnk+ZXJyb3IpO1xuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgb25TdWJtaXQodmFsdWU6IGFueSwgY2FyZE5hbWU6IHN0cmluZykge1xuICAgICAgICAvLyBTZW5kIHVwZGF0ZWQgdXNlciBvYmplY3QgdG8gYmFja2VuZFxuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmF1dGhTZXJ2aWNlLnVwZGF0ZVVzZXIodmFsdWUpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKFxuICAgICAgICAgICAgICAgIHJlcyA9PiBoYW5kbGVSZXNwb25zZShyZXMpLFxuICAgICAgICAgICAgICAgIGVyciA9PiBjb25zb2xlLmxvZygnZXJyIEB1cGRhdGVVc2VyOiAnLCBlcnIpXG4gICAgICAgICAgICApXG5cbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlUmVzcG9uc2UocmVzKSB7XG4gICAgICAgICAgICAvLyBBZnRlciBzYXZpbmcgc3VjY2Vzc2Z1bGx5IENsb3NlIHRoZSBzcGVjaWZpYyBjYXJkKGZvcm0pXG4gICAgICAgICAgICBzZWxmW2NhcmROYW1lXSA9ICEoc2VsZltjYXJkTmFtZV0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZWRpdChjYXJkTmFtZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXNbY2FyZE5hbWVdID0gISh0aGlzW2NhcmROYW1lXSk7XG4gICAgfVxuXG4gICAgY2hlY2tSb2xlKHJvbGU6IHN0cmluZywgdXNlcjogVXNlcikge1xuICAgICAgICAvL3JvbGUgaXMgdGhlIHJlcXVpcmVkIHJvbGUgdG8gYWNjZXNzIHRoZSBjb250ZW50XG4gICAgICAgIC8vVXNlcidzIHJvbGUgbXVzdCBoYXZlIGhpZ2hlciBvciBlcXVhbCBhdXRob3JpdHkgdG8gdGhpcyByb2xlXG4gICAgICAgIGlmKHVzZXIpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmF1dGhTZXJ2aWNlLmNoZWNrQXV0aG9yaXR5KHJvbGUsIHVzZXIucm9sZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBuZ09uSW5pdCgpIHtcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLmN1cnJlbnRVc2VyID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3VycmVudF91c2VyJykpO1xuICAgICAgICB0aGlzLmdldEN1cnJlbnRVc2VyKCk7XG4gICAgICAgIHRoaXMuc29ja2V0LnN5bmNCeUlkKCd1c2VyJywgdGhpcy5jdXJyZW50VXNlci5faWQsIGZ1bmN0aW9uKHVzZXIpIHtcbiAgICAgICAgICAgIHNlbGYuY3VycmVudFVzZXIgPSB1c2VyO1xuICAgICAgICB9KTtcbiAgICB9XG59XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
