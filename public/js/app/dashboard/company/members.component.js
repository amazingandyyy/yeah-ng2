"use strict";var __decorate=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),router_1=require("@angular/router"),moment=require("moment"),index_1=require("../../shared/services/index"),MembersComponent=function(){function e(e,t,s,r){this.router=e,this.authService=t,this.superadminService=s,this.userDataService=r,this.currentUser={},this.userDataList={},this.arrayOfUsersKeys=[],this.selectedUser={},this.studentsList=[],this.advisorsList=[],this.adminsList=[]}return e.prototype.getUser=function(){var e=this;this.authService.getCurrentUser(JSON.parse(localStorage.getItem("current_user"))._id).subscribe(function(t){e.currentUser=t},function(t){e.authService.logUserOut(),console.log(t)})},e.prototype.getUsers=function(){var e=this;this.superadminService.getAllUsers().subscribe(function(t){console.log("All Users: ",t),e.userDataList=t,e.arrayOfUsersKeys=Object.keys(t)},function(t){e.authService.logUserOut(),console.log(t)})},e.prototype.showSummary=function(){var e=this;return this.studentsList=[],this.advisorsList=[],this.adminsList=[],this.arrayOfUsersKeys.forEach(function(t){switch(console.log(t,e.userDataList[t]),e.userDataList[t].role){case"student":e.studentsList.push(e.userDataList[t]);break;case"advisor":e.advisorsList.push(e.userDataList[t]);break;case"admin":e.adminsList.push(e.userDataList[t])}}),"Total: "+this.arrayOfUsersKeys.length+" users ("+this.studentsList.length+" students, "+this.advisorsList.length+" advisors, "+this.adminsList.length+" admins)"},e.prototype.renderLLT=function(e){return moment(e).format("LLL")},e.prototype.getSingleUser=function(e){var t=this;this.selectedUserId=e,this.userDataService.getSingleUser(e).subscribe(function(e){e._id==t.selectedUserId&&(console.log("Single User: ",e),t.selectedUser=e)},function(e){console.log(e)})},e.prototype.ngOnInit=function(){this.currentUser=JSON.parse(localStorage.getItem("current_user")),this.getUser(),this.getUsers()},e=__decorate([core_1.Component({moduleId:module.id,selector:"yeah-members",templateUrl:"members.component.html",styleUrls:["company.style.css"],directives:[router_1.ROUTER_DIRECTIVES],providers:[index_1.AuthService,index_1.SuperadminService,index_1.UserDataService]}),__metadata("design:paramtypes",[router_1.Router,index_1.AuthService,index_1.SuperadminService,index_1.UserDataService])],e)}();exports.MembersComponent=MembersComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRhc2hib2FyZC9jb21wYW55L21lbWJlcnMuY29tcG9uZW50LmpzIiwiZGFzaGJvYXJkL2NvbXBhbnkvbWVtYmVycy5jb21wb25lbnQudHMiXSwibmFtZXMiOlsiX19kZWNvcmF0ZSIsInRoaXMiLCJkZWNvcmF0b3JzIiwidGFyZ2V0Iiwia2V5IiwiZGVzYyIsImQiLCJjIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiciIsIk9iamVjdCIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsIlJlZmxlY3QiLCJkZWNvcmF0ZSIsImkiLCJkZWZpbmVQcm9wZXJ0eSIsIl9fbWV0YWRhdGEiLCJrIiwidiIsIm1ldGFkYXRhIiwiY29yZV8xIiwicmVxdWlyZSIsInJvdXRlcl8xIiwibW9tZW50IiwiaW5kZXhfMSIsIk1lbWJlcnNDb21wb25lbnQiLCJyb3V0ZXIiLCJhdXRoU2VydmljZSIsInN1cGVyYWRtaW5TZXJ2aWNlIiwidXNlckRhdGFTZXJ2aWNlIiwiY3VycmVudFVzZXIiLCJ1c2VyRGF0YUxpc3QiLCJhcnJheU9mVXNlcnNLZXlzIiwic2VsZWN0ZWRVc2VyIiwic3R1ZGVudHNMaXN0IiwiYWR2aXNvcnNMaXN0IiwiYWRtaW5zTGlzdCIsInByb3RvdHlwZSIsImdldFVzZXIiLCJfdGhpcyIsImdldEN1cnJlbnRVc2VyIiwiSlNPTiIsInBhcnNlIiwibG9jYWxTdG9yYWdlIiwiZ2V0SXRlbSIsIl9pZCIsInN1YnNjcmliZSIsInVzZXIiLCJlcnJvciIsImxvZ1VzZXJPdXQiLCJjb25zb2xlIiwibG9nIiwiZ2V0VXNlcnMiLCJnZXRBbGxVc2VycyIsInVzZXJzIiwia2V5cyIsInNob3dTdW1tYXJ5IiwiZm9yRWFjaCIsInVzZXJLZXkiLCJyb2xlIiwicHVzaCIsInJlbmRlckxMVCIsInVuaXgiLCJmb3JtYXQiLCJnZXRTaW5nbGVVc2VyIiwidXNlcklkIiwic2VsZWN0ZWRVc2VySWQiLCJuZ09uSW5pdCIsIkNvbXBvbmVudCIsIm1vZHVsZUlkIiwibW9kdWxlIiwiaWQiLCJzZWxlY3RvciIsInRlbXBsYXRlVXJsIiwic3R5bGVVcmxzIiwiZGlyZWN0aXZlcyIsIlJPVVRFUl9ESVJFQ1RJVkVTIiwicHJvdmlkZXJzIiwiQXV0aFNlcnZpY2UiLCJTdXBlcmFkbWluU2VydmljZSIsIlVzZXJEYXRhU2VydmljZSIsIlJvdXRlciIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBLFlBQ0EsSUFBSUEsWUFBY0MsTUFBUUEsS0FBS0QsWUFBZSxTQUFVRSxFQUFZQyxFQUFRQyxFQUFLQyxHQUM3RSxHQUEySEMsR0FBdkhDLEVBQUlDLFVBQVVDLE9BQVFDLEVBQUlILEVBQUksRUFBSUosRUFBa0IsT0FBVEUsRUFBZ0JBLEVBQU9NLE9BQU9DLHlCQUF5QlQsRUFBUUMsR0FBT0MsQ0FDckgsSUFBdUIsZ0JBQVpRLFVBQW9ELGtCQUFyQkEsU0FBUUMsU0FBeUJKLEVBQUlHLFFBQVFDLFNBQVNaLEVBQVlDLEVBQVFDLEVBQUtDLE9BQ3BILEtBQUssR0FBSVUsR0FBSWIsRUFBV08sT0FBUyxFQUFHTSxHQUFLLEVBQUdBLEtBQVNULEVBQUlKLEVBQVdhLE1BQUlMLEdBQUtILEVBQUksRUFBSUQsRUFBRUksR0FBS0gsRUFBSSxFQUFJRCxFQUFFSCxFQUFRQyxFQUFLTSxHQUFLSixFQUFFSCxFQUFRQyxLQUFTTSxFQUNoSixPQUFPSCxHQUFJLEdBQUtHLEdBQUtDLE9BQU9LLGVBQWViLEVBQVFDLEVBQUtNLEdBQUlBLEdBRTVETyxXQUFjaEIsTUFBUUEsS0FBS2dCLFlBQWUsU0FBVUMsRUFBR0MsR0FDdkQsR0FBdUIsZ0JBQVpOLFVBQW9ELGtCQUFyQkEsU0FBUU8sU0FBeUIsTUFBT1AsU0FBUU8sU0FBU0YsRUFBR0MsSUNSMUdFLE9BQUFDLFFBQWtDLGlCQUNsQ0MsU0FBQUQsUUFBNkMsbUJBQ3RDRSxPQUFNRixRQUFXLFVBR3hCRyxRQUFBSCxRQUFnRSwrQkFVaEVJLGlCQUFBLFdBV0ksUUFBQUEsR0FDWUMsRUFDQUMsRUFDQUMsRUFDQUMsR0FIQTdCLEtBQUEwQixPQUFBQSxFQUNBMUIsS0FBQTJCLFlBQUFBLEVBQ0EzQixLQUFBNEIsa0JBQUFBLEVBQ0E1QixLQUFBNkIsZ0JBQUFBLEVBZEo3QixLQUFBOEIsZUFDQTlCLEtBQUErQixnQkFDQS9CLEtBQUFnQyxvQkFFQWhDLEtBQUFpQyxnQkFFQWpDLEtBQUFrQyxnQkFDQWxDLEtBQUFtQyxnQkFDQW5DLEtBQUFvQyxjQWdGWixNQXZFSVgsR0FBQVksVUFBQUMsUUFBQSxXQUFBLEdBQUFDLEdBQUF2QyxJQUNJQSxNQUFLMkIsWUFBWWEsZUFBZUMsS0FBS0MsTUFBTUMsYUFBYUMsUUFBUSxpQkFBaUJDLEtBQzVFQyxVQUNELFNBQUFDLEdBQ0lSLEVBQUtULFlBQWNpQixHQUV2QixTQUFBQyxHQUNJVCxFQUFLWixZQUFZc0IsYUFDakJDLFFBQVFDLElBQVNILE1BSTdCdkIsRUFBQVksVUFBQWUsU0FBQSxXQUFBLEdBQUFiLEdBQUF2QyxJQUNJQSxNQUFLNEIsa0JBQWtCeUIsY0FDbEJQLFVBQ0QsU0FBQVEsR0FDSUosUUFBUUMsSUFBSSxjQUFlRyxHQUMzQmYsRUFBS1IsYUFBZXVCLEVBQ3BCZixFQUFLUCxpQkFBbUJ0QixPQUFPNkMsS0FBS0QsSUFFeEMsU0FBQU4sR0FDSVQsRUFBS1osWUFBWXNCLGFBQ2pCQyxRQUFRQyxJQUFTSCxNQUk3QnZCLEVBQUFZLFVBQUFtQixZQUFBLFdBQUEsR0FBQWpCLEdBQUF2QyxJQWtCSSxPQWpCQUEsTUFBS2tDLGdCQUNMbEMsS0FBS21DLGdCQUNMbkMsS0FBS29DLGNBQ0xwQyxLQUFLZ0MsaUJBQWlCeUIsUUFBUSxTQUFBQyxHQUUxQixPQURBUixRQUFRQyxJQUFJTyxFQUFTbkIsRUFBS1IsYUFBYTJCLElBQy9CbkIsRUFBS1IsYUFBYTJCLEdBQVNDLE1BQy9CLElBQUssVUFDRHBCLEVBQUtMLGFBQWEwQixLQUFLckIsRUFBS1IsYUFBYTJCLEdBQ3pDLE1BQ0osS0FBSyxVQUNEbkIsRUFBS0osYUFBYXlCLEtBQUtyQixFQUFLUixhQUFhMkIsR0FDekMsTUFDSixLQUFLLFFBQ0RuQixFQUFLSCxXQUFXd0IsS0FBS3JCLEVBQUtSLGFBQWEyQixPQUk1QyxVQUFVMUQsS0FBS2dDLGlCQUFpQnhCLE9BQU0sV0FBV1IsS0FBS2tDLGFBQWExQixPQUFNLGNBQWNSLEtBQUttQyxhQUFhM0IsT0FBTSxjQUFjUixLQUFLb0MsV0FBVzVCLE9BQU0sWUFHOUppQixFQUFBWSxVQUFBd0IsVUFBQSxTQUFVQyxHQUNOLE1BQU92QyxRQUFPdUMsR0FBTUMsT0FBTyxRQUcvQnRDLEVBQUFZLFVBQUEyQixjQUFBLFNBQWNDLEdBQWQsR0FBQTFCLEdBQUF2QyxJQUNJQSxNQUFLa0UsZUFBaUJELEVBQ3RCakUsS0FBSzZCLGdCQUFnQm1DLGNBQWNDLEdBQzlCbkIsVUFDRCxTQUFBQyxHQUNRQSxFQUFLRixLQUFPTixFQUFLMkIsaUJBQ2pCaEIsUUFBUUMsSUFBSSxnQkFBaUJKLEdBQzdCUixFQUFLTixhQUFlYyxJQUc1QixTQUFBQyxHQUNJRSxRQUFRQyxJQUFTSCxNQUk3QnZCLEVBQUFZLFVBQUE4QixTQUFBLFdBQ0luRSxLQUFLOEIsWUFBY1csS0FBS0MsTUFBTUMsYUFBYUMsUUFBUSxpQkFDbkQ1QyxLQUFLc0MsVUFDTHRDLEtBQUtvRCxZQS9GYjNCLEVBQUExQixZQUFDcUIsT0FBQWdELFdBQ0dDLFNBQVVDLE9BQU9DLEdBQ2pCQyxTQUFVLGVBQ1ZDLFlBQWEseUJBQ2JDLFdBQVkscUJBQ1pDLFlBQWFyRCxTQUFBc0QsbUJBQ2JDLFdBQVlyRCxRQUFBc0QsWUFBYXRELFFBQUF1RCxrQkFBbUJ2RCxRQUFBd0QsbUJEd0Z4Q2hFLFdBQVcscUJBQXNCTSxTQUFTMkQsT0FBUXpELFFBQVFzRCxZQUFhdEQsUUFBUXVELGtCQUFtQnZELFFBQVF3RCxtQkFDM0d2RCxLQ3ZGTXlELFNBQUF6RCxpQkFBZ0JBIiwiZmlsZSI6ImRhc2hib2FyZC9jb21wYW55L21lbWJlcnMuY29tcG9uZW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG52YXIgX19tZXRhZGF0YSA9ICh0aGlzICYmIHRoaXMuX19tZXRhZGF0YSkgfHwgZnVuY3Rpb24gKGssIHYpIHtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEoaywgdik7XG59O1xudmFyIGNvcmVfMSA9IHJlcXVpcmUoJ0Bhbmd1bGFyL2NvcmUnKTtcbnZhciByb3V0ZXJfMSA9IHJlcXVpcmUoJ0Bhbmd1bGFyL3JvdXRlcicpO1xudmFyIG1vbWVudCA9IHJlcXVpcmUoJ21vbWVudCcpO1xudmFyIGluZGV4XzEgPSByZXF1aXJlKCcuLi8uLi9zaGFyZWQvc2VydmljZXMvaW5kZXgnKTtcbnZhciBNZW1iZXJzQ29tcG9uZW50ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBNZW1iZXJzQ29tcG9uZW50KHJvdXRlciwgYXV0aFNlcnZpY2UsIHN1cGVyYWRtaW5TZXJ2aWNlLCB1c2VyRGF0YVNlcnZpY2UpIHtcbiAgICAgICAgdGhpcy5yb3V0ZXIgPSByb3V0ZXI7XG4gICAgICAgIHRoaXMuYXV0aFNlcnZpY2UgPSBhdXRoU2VydmljZTtcbiAgICAgICAgdGhpcy5zdXBlcmFkbWluU2VydmljZSA9IHN1cGVyYWRtaW5TZXJ2aWNlO1xuICAgICAgICB0aGlzLnVzZXJEYXRhU2VydmljZSA9IHVzZXJEYXRhU2VydmljZTtcbiAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IHt9O1xuICAgICAgICB0aGlzLnVzZXJEYXRhTGlzdCA9IHt9O1xuICAgICAgICB0aGlzLmFycmF5T2ZVc2Vyc0tleXMgPSBbXTtcbiAgICAgICAgdGhpcy5zZWxlY3RlZFVzZXIgPSB7fTtcbiAgICAgICAgdGhpcy5zdHVkZW50c0xpc3QgPSBbXTtcbiAgICAgICAgdGhpcy5hZHZpc29yc0xpc3QgPSBbXTtcbiAgICAgICAgdGhpcy5hZG1pbnNMaXN0ID0gW107XG4gICAgfVxuICAgIE1lbWJlcnNDb21wb25lbnQucHJvdG90eXBlLmdldFVzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuYXV0aFNlcnZpY2UuZ2V0Q3VycmVudFVzZXIoSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3VycmVudF91c2VyJykpLl9pZClcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgICAgIF90aGlzLmN1cnJlbnRVc2VyID0gdXNlcjtcbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICBfdGhpcy5hdXRoU2VydmljZS5sb2dVc2VyT3V0KCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgTWVtYmVyc0NvbXBvbmVudC5wcm90b3R5cGUuZ2V0VXNlcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuc3VwZXJhZG1pblNlcnZpY2UuZ2V0QWxsVXNlcnMoKVxuICAgICAgICAgICAgLnN1YnNjcmliZShmdW5jdGlvbiAodXNlcnMpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdBbGwgVXNlcnM6ICcsIHVzZXJzKTtcbiAgICAgICAgICAgIF90aGlzLnVzZXJEYXRhTGlzdCA9IHVzZXJzO1xuICAgICAgICAgICAgX3RoaXMuYXJyYXlPZlVzZXJzS2V5cyA9IE9iamVjdC5rZXlzKHVzZXJzKTtcbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICBfdGhpcy5hdXRoU2VydmljZS5sb2dVc2VyT3V0KCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgTWVtYmVyc0NvbXBvbmVudC5wcm90b3R5cGUuc2hvd1N1bW1hcnkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuc3R1ZGVudHNMaXN0ID0gW107XG4gICAgICAgIHRoaXMuYWR2aXNvcnNMaXN0ID0gW107XG4gICAgICAgIHRoaXMuYWRtaW5zTGlzdCA9IFtdO1xuICAgICAgICB0aGlzLmFycmF5T2ZVc2Vyc0tleXMuZm9yRWFjaChmdW5jdGlvbiAodXNlcktleSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2codXNlcktleSwgX3RoaXMudXNlckRhdGFMaXN0W3VzZXJLZXldKTtcbiAgICAgICAgICAgIHN3aXRjaCAoX3RoaXMudXNlckRhdGFMaXN0W3VzZXJLZXldLnJvbGUpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdzdHVkZW50JzpcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuc3R1ZGVudHNMaXN0LnB1c2goX3RoaXMudXNlckRhdGFMaXN0W3VzZXJLZXldKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnYWR2aXNvcic6XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmFkdmlzb3JzTGlzdC5wdXNoKF90aGlzLnVzZXJEYXRhTGlzdFt1c2VyS2V5XSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2FkbWluJzpcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuYWRtaW5zTGlzdC5wdXNoKF90aGlzLnVzZXJEYXRhTGlzdFt1c2VyS2V5XSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIFwiVG90YWw6IFwiICsgdGhpcy5hcnJheU9mVXNlcnNLZXlzLmxlbmd0aCArIFwiIHVzZXJzIChcIiArIHRoaXMuc3R1ZGVudHNMaXN0Lmxlbmd0aCArIFwiIHN0dWRlbnRzLCBcIiArIHRoaXMuYWR2aXNvcnNMaXN0Lmxlbmd0aCArIFwiIGFkdmlzb3JzLCBcIiArIHRoaXMuYWRtaW5zTGlzdC5sZW5ndGggKyBcIiBhZG1pbnMpXCI7XG4gICAgfTtcbiAgICBNZW1iZXJzQ29tcG9uZW50LnByb3RvdHlwZS5yZW5kZXJMTFQgPSBmdW5jdGlvbiAodW5peCkge1xuICAgICAgICByZXR1cm4gbW9tZW50KHVuaXgpLmZvcm1hdCgnTExMJyk7XG4gICAgfTtcbiAgICBNZW1iZXJzQ29tcG9uZW50LnByb3RvdHlwZS5nZXRTaW5nbGVVc2VyID0gZnVuY3Rpb24gKHVzZXJJZCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnNlbGVjdGVkVXNlcklkID0gdXNlcklkO1xuICAgICAgICB0aGlzLnVzZXJEYXRhU2VydmljZS5nZXRTaW5nbGVVc2VyKHVzZXJJZClcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgICAgIGlmICh1c2VyLl9pZCA9PSBfdGhpcy5zZWxlY3RlZFVzZXJJZCkge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTaW5nbGUgVXNlcjogJywgdXNlcik7XG4gICAgICAgICAgICAgICAgX3RoaXMuc2VsZWN0ZWRVc2VyID0gdXNlcjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgTWVtYmVyc0NvbXBvbmVudC5wcm90b3R5cGUubmdPbkluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuY3VycmVudFVzZXIgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdjdXJyZW50X3VzZXInKSk7XG4gICAgICAgIHRoaXMuZ2V0VXNlcigpO1xuICAgICAgICB0aGlzLmdldFVzZXJzKCk7XG4gICAgfTtcbiAgICBNZW1iZXJzQ29tcG9uZW50ID0gX19kZWNvcmF0ZShbXG4gICAgICAgIGNvcmVfMS5Db21wb25lbnQoe1xuICAgICAgICAgICAgbW9kdWxlSWQ6IG1vZHVsZS5pZCxcbiAgICAgICAgICAgIHNlbGVjdG9yOiAneWVhaC1tZW1iZXJzJyxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnbWVtYmVycy5jb21wb25lbnQuaHRtbCcsXG4gICAgICAgICAgICBzdHlsZVVybHM6IFsnY29tcGFueS5zdHlsZS5jc3MnXSxcbiAgICAgICAgICAgIGRpcmVjdGl2ZXM6IFtyb3V0ZXJfMS5ST1VURVJfRElSRUNUSVZFU10sXG4gICAgICAgICAgICBwcm92aWRlcnM6IFtpbmRleF8xLkF1dGhTZXJ2aWNlLCBpbmRleF8xLlN1cGVyYWRtaW5TZXJ2aWNlLCBpbmRleF8xLlVzZXJEYXRhU2VydmljZV1cbiAgICAgICAgfSksIFxuICAgICAgICBfX21ldGFkYXRhKCdkZXNpZ246cGFyYW10eXBlcycsIFtyb3V0ZXJfMS5Sb3V0ZXIsIGluZGV4XzEuQXV0aFNlcnZpY2UsIGluZGV4XzEuU3VwZXJhZG1pblNlcnZpY2UsIGluZGV4XzEuVXNlckRhdGFTZXJ2aWNlXSlcbiAgICBdLCBNZW1iZXJzQ29tcG9uZW50KTtcbiAgICByZXR1cm4gTWVtYmVyc0NvbXBvbmVudDtcbn0oKSk7XG5leHBvcnRzLk1lbWJlcnNDb21wb25lbnQgPSBNZW1iZXJzQ29tcG9uZW50O1xuIiwiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFJvdXRlciwgUk9VVEVSX0RJUkVDVElWRVMgfSAgICBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xuaW1wb3J0IG1vbWVudCA9IHJlcXVpcmUoJ21vbWVudCcpO1xuXG5pbXBvcnQgeyBVc2VyIH0gZnJvbSAnLi4vLi4vc2hhcmVkL3R5cGVzL3VzZXInXG5pbXBvcnQgeyBBdXRoU2VydmljZSwgU3VwZXJhZG1pblNlcnZpY2UsIFVzZXJEYXRhU2VydmljZSB9IGZyb20gJy4uLy4uL3NoYXJlZC9zZXJ2aWNlcy9pbmRleCc7XG5cbkBDb21wb25lbnQoe1xuICAgIG1vZHVsZUlkOiBtb2R1bGUuaWQsXG4gICAgc2VsZWN0b3I6ICd5ZWFoLW1lbWJlcnMnLFxuICAgIHRlbXBsYXRlVXJsOiAnbWVtYmVycy5jb21wb25lbnQuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJ2NvbXBhbnkuc3R5bGUuY3NzJ10sXG4gICAgZGlyZWN0aXZlczogW1JPVVRFUl9ESVJFQ1RJVkVTXSxcbiAgICBwcm92aWRlcnM6IFtBdXRoU2VydmljZSwgU3VwZXJhZG1pblNlcnZpY2UsIFVzZXJEYXRhU2VydmljZV1cbn0pXG5leHBvcnQgY2xhc3MgTWVtYmVyc0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gICAgcHJpdmF0ZSBjdXJyZW50VXNlciA9IHt9O1xuICAgIHByaXZhdGUgdXNlckRhdGFMaXN0ID0ge307XG4gICAgcHJpdmF0ZSBhcnJheU9mVXNlcnNLZXlzID0gW107XG4gICAgcHJpdmF0ZSBzZWxlY3RlZFVzZXJJZDogc3RyaW5nO1xuICAgIHByaXZhdGUgc2VsZWN0ZWRVc2VyID0ge307XG5cbiAgICBwcml2YXRlIHN0dWRlbnRzTGlzdCA9IFtdO1xuICAgIHByaXZhdGUgYWR2aXNvcnNMaXN0ID0gW107XG4gICAgcHJpdmF0ZSBhZG1pbnNMaXN0ID0gW107XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSByb3V0ZXI6IFJvdXRlcixcbiAgICAgICAgcHJpdmF0ZSBhdXRoU2VydmljZTogQXV0aFNlcnZpY2UsXG4gICAgICAgIHByaXZhdGUgc3VwZXJhZG1pblNlcnZpY2U6IFN1cGVyYWRtaW5TZXJ2aWNlLFxuICAgICAgICBwcml2YXRlIHVzZXJEYXRhU2VydmljZTogVXNlckRhdGFTZXJ2aWNlXG4gICAgKSB7IH1cblxuICAgIGdldFVzZXIoKSB7XG4gICAgICAgIHRoaXMuYXV0aFNlcnZpY2UuZ2V0Q3VycmVudFVzZXIoSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3VycmVudF91c2VyJykpLl9pZClcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoXG4gICAgICAgICAgICB1c2VyID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRVc2VyID0gdXNlclxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmF1dGhTZXJ2aWNlLmxvZ1VzZXJPdXQoKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyg8YW55PmVycm9yKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIGdldFVzZXJzKCkge1xuICAgICAgICB0aGlzLnN1cGVyYWRtaW5TZXJ2aWNlLmdldEFsbFVzZXJzKClcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoXG4gICAgICAgICAgICB1c2VycyA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0FsbCBVc2VyczogJywgdXNlcnMpO1xuICAgICAgICAgICAgICAgIHRoaXMudXNlckRhdGFMaXN0ID0gdXNlcnM7XG4gICAgICAgICAgICAgICAgdGhpcy5hcnJheU9mVXNlcnNLZXlzID0gT2JqZWN0LmtleXModXNlcnMpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLmF1dGhTZXJ2aWNlLmxvZ1VzZXJPdXQoKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyg8YW55PmVycm9yKVxuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgc2hvd1N1bW1hcnkoKSB7XG4gICAgICAgIHRoaXMuc3R1ZGVudHNMaXN0ID0gW107XG4gICAgICAgIHRoaXMuYWR2aXNvcnNMaXN0ID0gW107XG4gICAgICAgIHRoaXMuYWRtaW5zTGlzdCA9IFtdO1xuICAgICAgICB0aGlzLmFycmF5T2ZVc2Vyc0tleXMuZm9yRWFjaCh1c2VyS2V5ID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHVzZXJLZXksIHRoaXMudXNlckRhdGFMaXN0W3VzZXJLZXldKTtcbiAgICAgICAgICAgIHN3aXRjaCAodGhpcy51c2VyRGF0YUxpc3RbdXNlcktleV0ucm9sZSkge1xuICAgICAgICAgICAgICAgIGNhc2UgJ3N0dWRlbnQnOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0dWRlbnRzTGlzdC5wdXNoKHRoaXMudXNlckRhdGFMaXN0W3VzZXJLZXldKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdhZHZpc29yJzpcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZHZpc29yc0xpc3QucHVzaCh0aGlzLnVzZXJEYXRhTGlzdFt1c2VyS2V5XSlcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnYWRtaW4nOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkbWluc0xpc3QucHVzaCh0aGlzLnVzZXJEYXRhTGlzdFt1c2VyS2V5XSlcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIHJldHVybiBgVG90YWw6ICR7dGhpcy5hcnJheU9mVXNlcnNLZXlzLmxlbmd0aH0gdXNlcnMgKCR7dGhpcy5zdHVkZW50c0xpc3QubGVuZ3RofSBzdHVkZW50cywgJHt0aGlzLmFkdmlzb3JzTGlzdC5sZW5ndGh9IGFkdmlzb3JzLCAke3RoaXMuYWRtaW5zTGlzdC5sZW5ndGh9IGFkbWlucylgXG4gICAgfVxuXG4gICAgcmVuZGVyTExUKHVuaXgpIHtcbiAgICAgICAgcmV0dXJuIG1vbWVudCh1bml4KS5mb3JtYXQoJ0xMTCcpO1xuICAgIH1cblxuICAgIGdldFNpbmdsZVVzZXIodXNlcklkOiBzdHJpbmcpIHtcbiAgICAgICAgdGhpcy5zZWxlY3RlZFVzZXJJZCA9IHVzZXJJZDtcbiAgICAgICAgdGhpcy51c2VyRGF0YVNlcnZpY2UuZ2V0U2luZ2xlVXNlcih1c2VySWQpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKFxuICAgICAgICAgICAgdXNlciA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHVzZXIuX2lkID09IHRoaXMuc2VsZWN0ZWRVc2VySWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ1NpbmdsZSBVc2VyOiAnLCB1c2VyKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFVzZXIgPSB1c2VyO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvciA9PiB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coPGFueT5lcnJvcilcbiAgICAgICAgICAgIH0pO1xuICAgIH1cblxuICAgIG5nT25Jbml0KCkge1xuICAgICAgICB0aGlzLmN1cnJlbnRVc2VyID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3VycmVudF91c2VyJykpO1xuICAgICAgICB0aGlzLmdldFVzZXIoKTtcbiAgICAgICAgdGhpcy5nZXRVc2VycygpO1xuICAgIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
