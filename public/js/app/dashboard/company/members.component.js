"use strict";var __decorate=this&&this.__decorate||function(e,t,s,r){var i,n=arguments.length,o=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,s):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,s,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(o=(n<3?i(o):n>3?i(t,s,o):i(t,s))||o);return n>3&&o&&Object.defineProperty(t,s,o),o},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),router_1=require("@angular/router"),moment=require("moment"),index_1=require("../../shared/services/index"),MembersComponent=function(){function e(e,t,s,r){this.router=e,this.authService=t,this.adminService=s,this.userDataService=r,this.currentUser={},this.userDataList={},this.arrayOfUsersKeys=[],this.selectedUser={},this.studentsList=[],this.advisorsList=[],this.adminsList=[]}return e.prototype.getUser=function(){var e=this;this.authService.getCurrentUser(JSON.parse(localStorage.getItem("current_user"))._id).subscribe(function(t){e.currentUser=t},function(t){e.authService.logUserOut(),console.log(t)})},e.prototype.getUsers=function(){var e=this;this.adminService.getAllUsers().subscribe(function(t){console.log("All Users: ",t),e.userDataList=t,e.arrayOfUsersKeys=Object.keys(t)},function(t){e.authService.logUserOut(),console.log(t)})},e.prototype.showSummary=function(){var e=this;return this.studentsList=[],this.advisorsList=[],this.adminsList=[],this.arrayOfUsersKeys.forEach(function(t){switch(console.log(t,e.userDataList[t]),e.userDataList[t].role){case"student":e.studentsList.push(e.userDataList[t]);break;case"advisor":e.advisorsList.push(e.userDataList[t]);break;case"admin":e.adminsList.push(e.userDataList[t])}}),"Total: "+this.arrayOfUsersKeys.length+" users ("+this.studentsList.length+" students, "+this.advisorsList.length+" advisors, "+this.adminsList.length+" admins)"},e.prototype.renderLLT=function(e){return moment(e).format("LLL")},e.prototype.getSingleUser=function(e){var t=this;this.selectedUserId=e,this.userDataService.getSingleUser(e).subscribe(function(e){e._id==t.selectedUserId&&(console.log("Single User: ",e),t.selectedUser=e)},function(e){console.log(e)})},e.prototype.ngOnInit=function(){this.currentUser=JSON.parse(localStorage.getItem("current_user")),this.getUser(),this.getUsers()},e=__decorate([core_1.Component({moduleId:module.id,selector:"yeah-members",templateUrl:"members.component.html",styleUrls:["company.style.css"],directives:[router_1.ROUTER_DIRECTIVES],providers:[index_1.AuthService,index_1.AdminService,index_1.UserDataService]}),__metadata("design:paramtypes",[router_1.Router,index_1.AuthService,index_1.AdminService,index_1.UserDataService])],e)}();exports.MembersComponent=MembersComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRhc2hib2FyZC9jb21wYW55L21lbWJlcnMuY29tcG9uZW50LmpzIiwiZGFzaGJvYXJkL2NvbXBhbnkvbWVtYmVycy5jb21wb25lbnQudHMiXSwibmFtZXMiOlsiX19kZWNvcmF0ZSIsInRoaXMiLCJkZWNvcmF0b3JzIiwidGFyZ2V0Iiwia2V5IiwiZGVzYyIsImQiLCJjIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiciIsIk9iamVjdCIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsIlJlZmxlY3QiLCJkZWNvcmF0ZSIsImkiLCJkZWZpbmVQcm9wZXJ0eSIsIl9fbWV0YWRhdGEiLCJrIiwidiIsIm1ldGFkYXRhIiwiY29yZV8xIiwicmVxdWlyZSIsInJvdXRlcl8xIiwibW9tZW50IiwiaW5kZXhfMSIsIk1lbWJlcnNDb21wb25lbnQiLCJyb3V0ZXIiLCJhdXRoU2VydmljZSIsImFkbWluU2VydmljZSIsInVzZXJEYXRhU2VydmljZSIsImN1cnJlbnRVc2VyIiwidXNlckRhdGFMaXN0IiwiYXJyYXlPZlVzZXJzS2V5cyIsInNlbGVjdGVkVXNlciIsInN0dWRlbnRzTGlzdCIsImFkdmlzb3JzTGlzdCIsImFkbWluc0xpc3QiLCJwcm90b3R5cGUiLCJnZXRVc2VyIiwiX3RoaXMiLCJnZXRDdXJyZW50VXNlciIsIkpTT04iLCJwYXJzZSIsImxvY2FsU3RvcmFnZSIsImdldEl0ZW0iLCJfaWQiLCJzdWJzY3JpYmUiLCJ1c2VyIiwiZXJyb3IiLCJsb2dVc2VyT3V0IiwiY29uc29sZSIsImxvZyIsImdldFVzZXJzIiwiZ2V0QWxsVXNlcnMiLCJ1c2VycyIsImtleXMiLCJzaG93U3VtbWFyeSIsImZvckVhY2giLCJ1c2VyS2V5Iiwicm9sZSIsInB1c2giLCJyZW5kZXJMTFQiLCJ1bml4IiwiZm9ybWF0IiwiZ2V0U2luZ2xlVXNlciIsInVzZXJJZCIsInNlbGVjdGVkVXNlcklkIiwibmdPbkluaXQiLCJDb21wb25lbnQiLCJtb2R1bGVJZCIsIm1vZHVsZSIsImlkIiwic2VsZWN0b3IiLCJ0ZW1wbGF0ZVVybCIsInN0eWxlVXJscyIsImRpcmVjdGl2ZXMiLCJST1VURVJfRElSRUNUSVZFUyIsInByb3ZpZGVycyIsIkF1dGhTZXJ2aWNlIiwiQWRtaW5TZXJ2aWNlIiwiVXNlckRhdGFTZXJ2aWNlIiwiUm91dGVyIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUEsWUFDQSxJQUFJQSxZQUFjQyxNQUFRQSxLQUFLRCxZQUFlLFNBQVVFLEVBQVlDLEVBQVFDLEVBQUtDLEdBQzdFLEdBQTJIQyxHQUF2SEMsRUFBSUMsVUFBVUMsT0FBUUMsRUFBSUgsRUFBSSxFQUFJSixFQUFrQixPQUFURSxFQUFnQkEsRUFBT00sT0FBT0MseUJBQXlCVCxFQUFRQyxHQUFPQyxDQUNySCxJQUF1QixnQkFBWlEsVUFBb0Qsa0JBQXJCQSxTQUFRQyxTQUF5QkosRUFBSUcsUUFBUUMsU0FBU1osRUFBWUMsRUFBUUMsRUFBS0MsT0FDcEgsS0FBSyxHQUFJVSxHQUFJYixFQUFXTyxPQUFTLEVBQUdNLEdBQUssRUFBR0EsS0FBU1QsRUFBSUosRUFBV2EsTUFBSUwsR0FBS0gsRUFBSSxFQUFJRCxFQUFFSSxHQUFLSCxFQUFJLEVBQUlELEVBQUVILEVBQVFDLEVBQUtNLEdBQUtKLEVBQUVILEVBQVFDLEtBQVNNLEVBQ2hKLE9BQU9ILEdBQUksR0FBS0csR0FBS0MsT0FBT0ssZUFBZWIsRUFBUUMsRUFBS00sR0FBSUEsR0FFNURPLFdBQWNoQixNQUFRQSxLQUFLZ0IsWUFBZSxTQUFVQyxFQUFHQyxHQUN2RCxHQUF1QixnQkFBWk4sVUFBb0Qsa0JBQXJCQSxTQUFRTyxTQUF5QixNQUFPUCxTQUFRTyxTQUFTRixFQUFHQyxJQ1IxR0UsT0FBQUMsUUFBa0MsaUJBQ2xDQyxTQUFBRCxRQUE2QyxtQkFDdENFLE9BQU1GLFFBQVcsVUFHeEJHLFFBQUFILFFBQTJELCtCQVUzREksaUJBQUEsV0FXSSxRQUFBQSxHQUNZQyxFQUNBQyxFQUNBQyxFQUNBQyxHQUhBN0IsS0FBQTBCLE9BQUFBLEVBQ0ExQixLQUFBMkIsWUFBQUEsRUFDQTNCLEtBQUE0QixhQUFBQSxFQUNBNUIsS0FBQTZCLGdCQUFBQSxFQWRKN0IsS0FBQThCLGVBQ0E5QixLQUFBK0IsZ0JBQ0EvQixLQUFBZ0Msb0JBRUFoQyxLQUFBaUMsZ0JBRUFqQyxLQUFBa0MsZ0JBQ0FsQyxLQUFBbUMsZ0JBQ0FuQyxLQUFBb0MsY0FpRlosTUF4RUlYLEdBQUFZLFVBQUFDLFFBQUEsV0FBQSxHQUFBQyxHQUFBdkMsSUFDSUEsTUFBSzJCLFlBQVlhLGVBQWVDLEtBQUtDLE1BQU1DLGFBQWFDLFFBQVEsaUJBQWlCQyxLQUM1RUMsVUFDRCxTQUFBQyxHQUNJUixFQUFLVCxZQUFjaUIsR0FFdkIsU0FBQUMsR0FDSVQsRUFBS1osWUFBWXNCLGFBQ2pCQyxRQUFRQyxJQUFTSCxNQUk3QnZCLEVBQUFZLFVBQUFlLFNBQUEsV0FBQSxHQUFBYixHQUFBdkMsSUFDSUEsTUFBSzRCLGFBQWF5QixjQUNiUCxVQUNELFNBQUFRLEdBQ0lKLFFBQVFDLElBQUksY0FBZUcsR0FDM0JmLEVBQUtSLGFBQWV1QixFQUNwQmYsRUFBS1AsaUJBQW1CdEIsT0FBTzZDLEtBQUtELElBRXhDLFNBQUFOLEdBQ0lULEVBQUtaLFlBQVlzQixhQUNqQkMsUUFBUUMsSUFBU0gsTUFJN0J2QixFQUFBWSxVQUFBbUIsWUFBQSxXQUFBLEdBQUFqQixHQUFBdkMsSUFrQkksT0FqQkFBLE1BQUtrQyxnQkFDTGxDLEtBQUttQyxnQkFDTG5DLEtBQUtvQyxjQUNMcEMsS0FBS2dDLGlCQUFpQnlCLFFBQVEsU0FBQUMsR0FFMUIsT0FEQVIsUUFBUUMsSUFBSU8sRUFBU25CLEVBQUtSLGFBQWEyQixJQUMvQm5CLEVBQUtSLGFBQWEyQixHQUFTQyxNQUMvQixJQUFLLFVBQ0RwQixFQUFLTCxhQUFhMEIsS0FBS3JCLEVBQUtSLGFBQWEyQixHQUN6QyxNQUNKLEtBQUssVUFDRG5CLEVBQUtKLGFBQWF5QixLQUFLckIsRUFBS1IsYUFBYTJCLEdBQ3pDLE1BQ0osS0FBSyxRQUNEbkIsRUFBS0gsV0FBV3dCLEtBQUtyQixFQUFLUixhQUFhMkIsT0FJNUMsVUFBVTFELEtBQUtnQyxpQkFBaUJ4QixPQUFNLFdBQVdSLEtBQUtrQyxhQUFhMUIsT0FBTSxjQUFjUixLQUFLbUMsYUFBYTNCLE9BQU0sY0FBY1IsS0FBS29DLFdBQVc1QixPQUFNLFlBRzlKaUIsRUFBQVksVUFBQXdCLFVBQUEsU0FBVUMsR0FDTixNQUFPdkMsUUFBT3VDLEdBQU1DLE9BQU8sUUFHL0J0QyxFQUFBWSxVQUFBMkIsY0FBQSxTQUFjQyxHQUFkLEdBQUExQixHQUFBdkMsSUFDSUEsTUFBS2tFLGVBQWlCRCxFQUN0QmpFLEtBQUs2QixnQkFBZ0JtQyxjQUFjQyxHQUM5Qm5CLFVBQ0QsU0FBQUMsR0FDUUEsRUFBS0YsS0FBT04sRUFBSzJCLGlCQUNqQmhCLFFBQVFDLElBQUksZ0JBQWlCSixHQUM3QlIsRUFBS04sYUFBZWMsSUFHNUIsU0FBQUMsR0FDSUUsUUFBUUMsSUFBU0gsTUFLN0J2QixFQUFBWSxVQUFBOEIsU0FBQSxXQUNJbkUsS0FBSzhCLFlBQWNXLEtBQUtDLE1BQU1DLGFBQWFDLFFBQVEsaUJBQ25ENUMsS0FBS3NDLFVBQ0x0QyxLQUFLb0QsWUFoR2IzQixFQUFBMUIsWUFBQ3FCLE9BQUFnRCxXQUNHQyxTQUFVQyxPQUFPQyxHQUNqQkMsU0FBVSxlQUNWQyxZQUFhLHlCQUNiQyxXQUFZLHFCQUNaQyxZQUFhckQsU0FBQXNELG1CQUNiQyxXQUFZckQsUUFBQXNELFlBQWF0RCxRQUFBdUQsYUFBY3ZELFFBQUF3RCxtQkR3Rm5DaEUsV0FBVyxxQkFBc0JNLFNBQVMyRCxPQUFRekQsUUFBUXNELFlBQWF0RCxRQUFRdUQsYUFBY3ZELFFBQVF3RCxtQkFDdEd2RCxLQ3ZGTXlELFNBQUF6RCxpQkFBZ0JBIiwiZmlsZSI6ImRhc2hib2FyZC9jb21wYW55L21lbWJlcnMuY29tcG9uZW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG52YXIgX19tZXRhZGF0YSA9ICh0aGlzICYmIHRoaXMuX19tZXRhZGF0YSkgfHwgZnVuY3Rpb24gKGssIHYpIHtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEoaywgdik7XG59O1xudmFyIGNvcmVfMSA9IHJlcXVpcmUoJ0Bhbmd1bGFyL2NvcmUnKTtcbnZhciByb3V0ZXJfMSA9IHJlcXVpcmUoJ0Bhbmd1bGFyL3JvdXRlcicpO1xudmFyIG1vbWVudCA9IHJlcXVpcmUoJ21vbWVudCcpO1xudmFyIGluZGV4XzEgPSByZXF1aXJlKCcuLi8uLi9zaGFyZWQvc2VydmljZXMvaW5kZXgnKTtcbnZhciBNZW1iZXJzQ29tcG9uZW50ID0gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBNZW1iZXJzQ29tcG9uZW50KHJvdXRlciwgYXV0aFNlcnZpY2UsIGFkbWluU2VydmljZSwgdXNlckRhdGFTZXJ2aWNlKSB7XG4gICAgICAgIHRoaXMucm91dGVyID0gcm91dGVyO1xuICAgICAgICB0aGlzLmF1dGhTZXJ2aWNlID0gYXV0aFNlcnZpY2U7XG4gICAgICAgIHRoaXMuYWRtaW5TZXJ2aWNlID0gYWRtaW5TZXJ2aWNlO1xuICAgICAgICB0aGlzLnVzZXJEYXRhU2VydmljZSA9IHVzZXJEYXRhU2VydmljZTtcbiAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IHt9O1xuICAgICAgICB0aGlzLnVzZXJEYXRhTGlzdCA9IHt9O1xuICAgICAgICB0aGlzLmFycmF5T2ZVc2Vyc0tleXMgPSBbXTtcbiAgICAgICAgdGhpcy5zZWxlY3RlZFVzZXIgPSB7fTtcbiAgICAgICAgdGhpcy5zdHVkZW50c0xpc3QgPSBbXTtcbiAgICAgICAgdGhpcy5hZHZpc29yc0xpc3QgPSBbXTtcbiAgICAgICAgdGhpcy5hZG1pbnNMaXN0ID0gW107XG4gICAgfVxuICAgIE1lbWJlcnNDb21wb25lbnQucHJvdG90eXBlLmdldFVzZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuYXV0aFNlcnZpY2UuZ2V0Q3VycmVudFVzZXIoSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3VycmVudF91c2VyJykpLl9pZClcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoZnVuY3Rpb24gKHVzZXIpIHtcbiAgICAgICAgICAgIF90aGlzLmN1cnJlbnRVc2VyID0gdXNlcjtcbiAgICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICBfdGhpcy5hdXRoU2VydmljZS5sb2dVc2VyT3V0KCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgTWVtYmVyc0NvbXBvbmVudC5wcm90b3R5cGUuZ2V0VXNlcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHRoaXMuYWRtaW5TZXJ2aWNlLmdldEFsbFVzZXJzKClcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoZnVuY3Rpb24gKHVzZXJzKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnQWxsIFVzZXJzOiAnLCB1c2Vycyk7XG4gICAgICAgICAgICBfdGhpcy51c2VyRGF0YUxpc3QgPSB1c2VycztcbiAgICAgICAgICAgIF90aGlzLmFycmF5T2ZVc2Vyc0tleXMgPSBPYmplY3Qua2V5cyh1c2Vycyk7XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgX3RoaXMuYXV0aFNlcnZpY2UubG9nVXNlck91dCgpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIE1lbWJlcnNDb21wb25lbnQucHJvdG90eXBlLnNob3dTdW1tYXJ5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnN0dWRlbnRzTGlzdCA9IFtdO1xuICAgICAgICB0aGlzLmFkdmlzb3JzTGlzdCA9IFtdO1xuICAgICAgICB0aGlzLmFkbWluc0xpc3QgPSBbXTtcbiAgICAgICAgdGhpcy5hcnJheU9mVXNlcnNLZXlzLmZvckVhY2goZnVuY3Rpb24gKHVzZXJLZXkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHVzZXJLZXksIF90aGlzLnVzZXJEYXRhTGlzdFt1c2VyS2V5XSk7XG4gICAgICAgICAgICBzd2l0Y2ggKF90aGlzLnVzZXJEYXRhTGlzdFt1c2VyS2V5XS5yb2xlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnc3R1ZGVudCc6XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnN0dWRlbnRzTGlzdC5wdXNoKF90aGlzLnVzZXJEYXRhTGlzdFt1c2VyS2V5XSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2Fkdmlzb3InOlxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5hZHZpc29yc0xpc3QucHVzaChfdGhpcy51c2VyRGF0YUxpc3RbdXNlcktleV0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdhZG1pbic6XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmFkbWluc0xpc3QucHVzaChfdGhpcy51c2VyRGF0YUxpc3RbdXNlcktleV0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBcIlRvdGFsOiBcIiArIHRoaXMuYXJyYXlPZlVzZXJzS2V5cy5sZW5ndGggKyBcIiB1c2VycyAoXCIgKyB0aGlzLnN0dWRlbnRzTGlzdC5sZW5ndGggKyBcIiBzdHVkZW50cywgXCIgKyB0aGlzLmFkdmlzb3JzTGlzdC5sZW5ndGggKyBcIiBhZHZpc29ycywgXCIgKyB0aGlzLmFkbWluc0xpc3QubGVuZ3RoICsgXCIgYWRtaW5zKVwiO1xuICAgIH07XG4gICAgTWVtYmVyc0NvbXBvbmVudC5wcm90b3R5cGUucmVuZGVyTExUID0gZnVuY3Rpb24gKHVuaXgpIHtcbiAgICAgICAgcmV0dXJuIG1vbWVudCh1bml4KS5mb3JtYXQoJ0xMTCcpO1xuICAgIH07XG4gICAgTWVtYmVyc0NvbXBvbmVudC5wcm90b3R5cGUuZ2V0U2luZ2xlVXNlciA9IGZ1bmN0aW9uICh1c2VySWQpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5zZWxlY3RlZFVzZXJJZCA9IHVzZXJJZDtcbiAgICAgICAgdGhpcy51c2VyRGF0YVNlcnZpY2UuZ2V0U2luZ2xlVXNlcih1c2VySWQpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKGZ1bmN0aW9uICh1c2VyKSB7XG4gICAgICAgICAgICBpZiAodXNlci5faWQgPT0gX3RoaXMuc2VsZWN0ZWRVc2VySWQpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU2luZ2xlIFVzZXI6ICcsIHVzZXIpO1xuICAgICAgICAgICAgICAgIF90aGlzLnNlbGVjdGVkVXNlciA9IHVzZXI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIE1lbWJlcnNDb21wb25lbnQucHJvdG90eXBlLm5nT25Jbml0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmN1cnJlbnRVc2VyID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY3VycmVudF91c2VyJykpO1xuICAgICAgICB0aGlzLmdldFVzZXIoKTtcbiAgICAgICAgdGhpcy5nZXRVc2VycygpO1xuICAgIH07XG4gICAgTWVtYmVyc0NvbXBvbmVudCA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBjb3JlXzEuQ29tcG9uZW50KHtcbiAgICAgICAgICAgIG1vZHVsZUlkOiBtb2R1bGUuaWQsXG4gICAgICAgICAgICBzZWxlY3RvcjogJ3llYWgtbWVtYmVycycsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ21lbWJlcnMuY29tcG9uZW50Lmh0bWwnLFxuICAgICAgICAgICAgc3R5bGVVcmxzOiBbJ2NvbXBhbnkuc3R5bGUuY3NzJ10sXG4gICAgICAgICAgICBkaXJlY3RpdmVzOiBbcm91dGVyXzEuUk9VVEVSX0RJUkVDVElWRVNdLFxuICAgICAgICAgICAgcHJvdmlkZXJzOiBbaW5kZXhfMS5BdXRoU2VydmljZSwgaW5kZXhfMS5BZG1pblNlcnZpY2UsIGluZGV4XzEuVXNlckRhdGFTZXJ2aWNlXVxuICAgICAgICB9KSwgXG4gICAgICAgIF9fbWV0YWRhdGEoJ2Rlc2lnbjpwYXJhbXR5cGVzJywgW3JvdXRlcl8xLlJvdXRlciwgaW5kZXhfMS5BdXRoU2VydmljZSwgaW5kZXhfMS5BZG1pblNlcnZpY2UsIGluZGV4XzEuVXNlckRhdGFTZXJ2aWNlXSlcbiAgICBdLCBNZW1iZXJzQ29tcG9uZW50KTtcbiAgICByZXR1cm4gTWVtYmVyc0NvbXBvbmVudDtcbn0oKSk7XG5leHBvcnRzLk1lbWJlcnNDb21wb25lbnQgPSBNZW1iZXJzQ29tcG9uZW50O1xuIiwiaW1wb3J0IHsgQ29tcG9uZW50LCBPbkluaXQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IFJvdXRlciwgUk9VVEVSX0RJUkVDVElWRVMgfSAgICBmcm9tICdAYW5ndWxhci9yb3V0ZXInO1xuaW1wb3J0IG1vbWVudCA9IHJlcXVpcmUoJ21vbWVudCcpO1xuXG5pbXBvcnQgeyBVc2VyIH0gZnJvbSAnLi4vLi4vc2hhcmVkL3R5cGVzL3VzZXInXG5pbXBvcnQgeyBBdXRoU2VydmljZSwgQWRtaW5TZXJ2aWNlLCBVc2VyRGF0YVNlcnZpY2UgfSBmcm9tICcuLi8uLi9zaGFyZWQvc2VydmljZXMvaW5kZXgnO1xuXG5AQ29tcG9uZW50KHtcbiAgICBtb2R1bGVJZDogbW9kdWxlLmlkLFxuICAgIHNlbGVjdG9yOiAneWVhaC1tZW1iZXJzJyxcbiAgICB0ZW1wbGF0ZVVybDogJ21lbWJlcnMuY29tcG9uZW50Lmh0bWwnLFxuICAgIHN0eWxlVXJsczogWydjb21wYW55LnN0eWxlLmNzcyddLFxuICAgIGRpcmVjdGl2ZXM6IFtST1VURVJfRElSRUNUSVZFU10sXG4gICAgcHJvdmlkZXJzOiBbQXV0aFNlcnZpY2UsIEFkbWluU2VydmljZSwgVXNlckRhdGFTZXJ2aWNlXVxufSlcbmV4cG9ydCBjbGFzcyBNZW1iZXJzQ29tcG9uZW50IGltcGxlbWVudHMgT25Jbml0IHtcbiAgICBwcml2YXRlIGN1cnJlbnRVc2VyID0ge307XG4gICAgcHJpdmF0ZSB1c2VyRGF0YUxpc3QgPSB7fTtcbiAgICBwcml2YXRlIGFycmF5T2ZVc2Vyc0tleXMgPSBbXTtcbiAgICBwcml2YXRlIHNlbGVjdGVkVXNlcklkOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBzZWxlY3RlZFVzZXIgPSB7fTtcblxuICAgIHByaXZhdGUgc3R1ZGVudHNMaXN0ID0gW107XG4gICAgcHJpdmF0ZSBhZHZpc29yc0xpc3QgPSBbXTtcbiAgICBwcml2YXRlIGFkbWluc0xpc3QgPSBbXTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHJvdXRlcjogUm91dGVyLFxuICAgICAgICBwcml2YXRlIGF1dGhTZXJ2aWNlOiBBdXRoU2VydmljZSxcbiAgICAgICAgcHJpdmF0ZSBhZG1pblNlcnZpY2U6IEFkbWluU2VydmljZSxcbiAgICAgICAgcHJpdmF0ZSB1c2VyRGF0YVNlcnZpY2U6IFVzZXJEYXRhU2VydmljZVxuICAgICkgeyB9XG5cbiAgICBnZXRVc2VyKCkge1xuICAgICAgICB0aGlzLmF1dGhTZXJ2aWNlLmdldEN1cnJlbnRVc2VyKEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2N1cnJlbnRfdXNlcicpKS5faWQpXG4gICAgICAgICAgICAuc3Vic2NyaWJlKFxuICAgICAgICAgICAgdXNlciA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IHVzZXJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBlcnJvciA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5hdXRoU2VydmljZS5sb2dVc2VyT3V0KCk7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coPGFueT5lcnJvcik7XG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBnZXRVc2VycygpIHtcbiAgICAgICAgdGhpcy5hZG1pblNlcnZpY2UuZ2V0QWxsVXNlcnMoKVxuICAgICAgICAgICAgLnN1YnNjcmliZShcbiAgICAgICAgICAgIHVzZXJzID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnQWxsIFVzZXJzOiAnLCB1c2Vycyk7XG4gICAgICAgICAgICAgICAgdGhpcy51c2VyRGF0YUxpc3QgPSB1c2VycztcbiAgICAgICAgICAgICAgICB0aGlzLmFycmF5T2ZVc2Vyc0tleXMgPSBPYmplY3Qua2V5cyh1c2Vycyk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3IgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuYXV0aFNlcnZpY2UubG9nVXNlck91dCgpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKDxhbnk+ZXJyb3IpXG4gICAgICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBzaG93U3VtbWFyeSgpIHtcbiAgICAgICAgdGhpcy5zdHVkZW50c0xpc3QgPSBbXTtcbiAgICAgICAgdGhpcy5hZHZpc29yc0xpc3QgPSBbXTtcbiAgICAgICAgdGhpcy5hZG1pbnNMaXN0ID0gW107XG4gICAgICAgIHRoaXMuYXJyYXlPZlVzZXJzS2V5cy5mb3JFYWNoKHVzZXJLZXkgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5sb2codXNlcktleSwgdGhpcy51c2VyRGF0YUxpc3RbdXNlcktleV0pO1xuICAgICAgICAgICAgc3dpdGNoICh0aGlzLnVzZXJEYXRhTGlzdFt1c2VyS2V5XS5yb2xlKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnc3R1ZGVudCc6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3R1ZGVudHNMaXN0LnB1c2godGhpcy51c2VyRGF0YUxpc3RbdXNlcktleV0pXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ2Fkdmlzb3InOlxuICAgICAgICAgICAgICAgICAgICB0aGlzLmFkdmlzb3JzTGlzdC5wdXNoKHRoaXMudXNlckRhdGFMaXN0W3VzZXJLZXldKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdhZG1pbic6XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRtaW5zTGlzdC5wdXNoKHRoaXMudXNlckRhdGFMaXN0W3VzZXJLZXldKVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuIGBUb3RhbDogJHt0aGlzLmFycmF5T2ZVc2Vyc0tleXMubGVuZ3RofSB1c2VycyAoJHt0aGlzLnN0dWRlbnRzTGlzdC5sZW5ndGh9IHN0dWRlbnRzLCAke3RoaXMuYWR2aXNvcnNMaXN0Lmxlbmd0aH0gYWR2aXNvcnMsICR7dGhpcy5hZG1pbnNMaXN0Lmxlbmd0aH0gYWRtaW5zKWBcbiAgICB9XG5cbiAgICByZW5kZXJMTFQodW5peCkge1xuICAgICAgICByZXR1cm4gbW9tZW50KHVuaXgpLmZvcm1hdCgnTExMJyk7XG4gICAgfVxuXG4gICAgZ2V0U2luZ2xlVXNlcih1c2VySWQ6IHN0cmluZykge1xuICAgICAgICB0aGlzLnNlbGVjdGVkVXNlcklkID0gdXNlcklkO1xuICAgICAgICB0aGlzLnVzZXJEYXRhU2VydmljZS5nZXRTaW5nbGVVc2VyKHVzZXJJZClcbiAgICAgICAgICAgIC5zdWJzY3JpYmUoXG4gICAgICAgICAgICB1c2VyID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodXNlci5faWQgPT0gdGhpcy5zZWxlY3RlZFVzZXJJZCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnU2luZ2xlIFVzZXI6ICcsIHVzZXIpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkVXNlciA9IHVzZXI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yID0+IHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyg8YW55PmVycm9yKVxuICAgICAgICAgICAgfSk7XG4gICAgfVxuXG5cbiAgICBuZ09uSW5pdCgpIHtcbiAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2N1cnJlbnRfdXNlcicpKTtcbiAgICAgICAgdGhpcy5nZXRVc2VyKCk7XG4gICAgICAgIHRoaXMuZ2V0VXNlcnMoKTtcbiAgICB9XG59XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
