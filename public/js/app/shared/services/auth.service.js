"use strict";var __decorate=this&&this.__decorate||function(e,t,r,o){var a,n=arguments.length,s=n<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,r,o);else for(var i=e.length-1;i>=0;i--)(a=e[i])&&(s=(n<3?a(s):n>3?a(t,r,s):a(t,r))||s);return n>3&&s&&Object.defineProperty(t,r,s),s},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),http_1=require("@angular/http"),router_1=require("@angular/router"),Observable_1=require("rxjs/Observable"),angular2_jwt_1=require("angular2-jwt");require("rxjs/add/observable/of"),require("rxjs/add/operator/do"),require("rxjs/add/operator/delay"),require("rxjs/add/operator/catch"),require("rxjs/add/operator/map");var AuthService=function(){function e(e,t,r){this.http=e,this.authHttp=t,this.router=r}return e.prototype.getCurrentUser=function(e){return this.authHttp.get("/api/user/currentUser/"+e).map(this.handelResponse)["catch"](this.handelError)},e.prototype.signUp=function(e){return this.http.post("/api/user/signup",e).map(this.handelResponse)["catch"](this.handelError)},e.prototype.logUserIn=function(e){return this.http.post("/api/user/login",e).map(this.handelResponse)["catch"](this.handelError)},e.prototype.logUserOut=function(){return localStorage.removeItem("id_token"),localStorage.removeItem("current_user"),this.isLoggedIn=!1,this.router.navigate(["/"]),"logout"},e.prototype.updateUser=function(e){return(null===e.password||e.password)&&delete e.password,this.http.post("/api/user/update",e).map(this.handelResponse)["catch"](this.handelError)},e.prototype.handelResponse=function(e){var t=e.json();return this.isLoggedIn=!0,this.currentUser=t,t||{}},e.prototype.handelError=function(e){return console.log("err @authService: ",e),this.isLoggedIn=!1,Observable_1.Observable["throw"](e)},e=__decorate([core_1.Injectable(),__metadata("design:paramtypes",[http_1.Http,angular2_jwt_1.AuthHttp,router_1.Router])],e)}();exports.AuthService=AuthService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNoYXJlZC9zZXJ2aWNlcy9hdXRoLnNlcnZpY2UuanMiLCJzaGFyZWQvc2VydmljZXMvYXV0aC5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbIl9fZGVjb3JhdGUiLCJ0aGlzIiwiZGVjb3JhdG9ycyIsInRhcmdldCIsImtleSIsImRlc2MiLCJkIiwiYyIsImFyZ3VtZW50cyIsImxlbmd0aCIsInIiLCJPYmplY3QiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJSZWZsZWN0IiwiZGVjb3JhdGUiLCJpIiwiZGVmaW5lUHJvcGVydHkiLCJfX21ldGFkYXRhIiwiayIsInYiLCJtZXRhZGF0YSIsImNvcmVfMSIsInJlcXVpcmUiLCJodHRwXzEiLCJyb3V0ZXJfMSIsIk9ic2VydmFibGVfMSIsImFuZ3VsYXIyX2p3dF8xIiwiQXV0aFNlcnZpY2UiLCJodHRwIiwiYXV0aEh0dHAiLCJyb3V0ZXIiLCJwcm90b3R5cGUiLCJnZXRDdXJyZW50VXNlciIsInVzZXJJZCIsImdldCIsIm1hcCIsImhhbmRlbFJlc3BvbnNlIiwiaGFuZGVsRXJyb3IiLCJzaWduVXAiLCJkYXRhIiwicG9zdCIsImxvZ1VzZXJJbiIsImxvZ1VzZXJPdXQiLCJsb2NhbFN0b3JhZ2UiLCJyZW1vdmVJdGVtIiwiaXNMb2dnZWRJbiIsIm5hdmlnYXRlIiwidXBkYXRlVXNlciIsInBhc3N3b3JkIiwicmVzIiwianNvbiIsImN1cnJlbnRVc2VyIiwiZXJyIiwiY29uc29sZSIsImxvZyIsIk9ic2VydmFibGUiLCJJbmplY3RhYmxlIiwiSHR0cCIsIkF1dGhIdHRwIiwiUm91dGVyIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IkFBQUEsWUFDQSxJQUFJQSxZQUFjQyxNQUFRQSxLQUFLRCxZQUFlLFNBQVVFLEVBQVlDLEVBQVFDLEVBQUtDLEdBQzdFLEdBQTJIQyxHQUF2SEMsRUFBSUMsVUFBVUMsT0FBUUMsRUFBSUgsRUFBSSxFQUFJSixFQUFrQixPQUFURSxFQUFnQkEsRUFBT00sT0FBT0MseUJBQXlCVCxFQUFRQyxHQUFPQyxDQUNySCxJQUF1QixnQkFBWlEsVUFBb0Qsa0JBQXJCQSxTQUFRQyxTQUF5QkosRUFBSUcsUUFBUUMsU0FBU1osRUFBWUMsRUFBUUMsRUFBS0MsT0FDcEgsS0FBSyxHQUFJVSxHQUFJYixFQUFXTyxPQUFTLEVBQUdNLEdBQUssRUFBR0EsS0FBU1QsRUFBSUosRUFBV2EsTUFBSUwsR0FBS0gsRUFBSSxFQUFJRCxFQUFFSSxHQUFLSCxFQUFJLEVBQUlELEVBQUVILEVBQVFDLEVBQUtNLEdBQUtKLEVBQUVILEVBQVFDLEtBQVNNLEVBQ2hKLE9BQU9ILEdBQUksR0FBS0csR0FBS0MsT0FBT0ssZUFBZWIsRUFBUUMsRUFBS00sR0FBSUEsR0FFNURPLFdBQWNoQixNQUFRQSxLQUFLZ0IsWUFBZSxTQUFVQyxFQUFHQyxHQUN2RCxHQUF1QixnQkFBWk4sVUFBb0Qsa0JBQXJCQSxTQUFRTyxTQUF5QixNQUFPUCxTQUFRTyxTQUFTRixFQUFHQyxJQ1IxR0UsT0FBQUMsUUFBMkIsaUJBQzNCQyxPQUFBRCxRQUErQixpQkFDL0JFLFNBQUFGLFFBQXVCLG1CQUN2QkcsYUFBQUgsUUFBMkIsbUJBQzNCSSxlQUFBSixRQUF5QixlQUV6QkEsU0FBTywwQkFDUEEsUUFBTyx3QkFDUEEsUUFBTywyQkFDUEEsUUFBTywyQkFDUEEsUUFBTyx3QkFPUCxJQUFBSyxhQUFBLFdBS0ksUUFBQUEsR0FDWUMsRUFDQUMsRUFDQUMsR0FGQTdCLEtBQUEyQixLQUFBQSxFQUNBM0IsS0FBQTRCLFNBQUFBLEVBQ0E1QixLQUFBNkIsT0FBQUEsRUF3RGhCLE1BckRJSCxHQUFBSSxVQUFBQyxlQUFBLFNBQWVDLEdBQ1gsTUFBT2hDLE1BQUs0QixTQUFTSyxJQUFJLHlCQUF5QkQsR0FDN0NFLElBQUlsQyxLQUFLbUMsZ0JBRFBuQyxTQUVJQSxLQUFLb0MsY0FHcEJWLEVBQUFJLFVBQUFPLE9BQUEsU0FBT0MsR0FDSCxNQUFPdEMsTUFBSzJCLEtBQUtZLEtBQUssbUJBQW9CRCxHQUNyQ0osSUFBSWxDLEtBQUttQyxnQkFEUG5DLFNBRUlBLEtBQUtvQyxjQUdwQlYsRUFBQUksVUFBQVUsVUFBQSxTQUFVRixHQUNOLE1BQU90QyxNQUFLMkIsS0FBS1ksS0FBSyxrQkFBbUJELEdBQ3BDSixJQUFJbEMsS0FBS21DLGdCQURQbkMsU0FFSUEsS0FBS29DLGNBR3BCVixFQUFBSSxVQUFBVyxXQUFBLFdBS0ksTUFKQUMsY0FBYUMsV0FBVyxZQUN4QkQsYUFBYUMsV0FBVyxnQkFDeEIzQyxLQUFLNEMsWUFBYSxFQUNsQjVDLEtBQUs2QixPQUFPZ0IsVUFBVSxNQUNmLFVBR1huQixFQUFBSSxVQUFBZ0IsV0FBQSxTQUFXUixHQU1QLE9BSnFCLE9BQWxCQSxFQUFLUyxVQUFxQlQsRUFBS1MsaUJBQ3ZCVCxHQUFLUyxTQUdUL0MsS0FBSzJCLEtBQUtZLEtBQUssbUJBQW9CRCxHQUNyQ0osSUFBSWxDLEtBQUttQyxnQkFEUG5DLFNBRUlBLEtBQUtvQyxjQUdwQlYsRUFBQUksVUFBQUssZUFBQSxTQUFlYSxHQUVYLEdBQUlWLEdBQU9VLEVBQUlDLE1BS2YsT0FIQWpELE1BQUs0QyxZQUFhLEVBRWxCNUMsS0FBS2tELFlBQWNaLEVBQ1pBLE9BR1ZaLEVBQUFJLFVBQUFNLFlBQUEsU0FBWWUsR0FHVCxNQUZBQyxTQUFRQyxJQUFJLHFCQUFzQkYsR0FDbENuRCxLQUFLNEMsWUFBYSxFQUNYcEIsYUFBQThCLFdBQUE5QixTQUFpQjJCLElBOURoQ3pCLEVBQUEzQixZQUFDcUIsT0FBQW1DLGFEeURPdkMsV0FBVyxxQkFBc0JNLE9BQU9rQyxLQUFNL0IsZUFBZWdDLFNBQVVsQyxTQUFTbUMsVUFDakZoQyxLQ3pETWlDLFNBQUFqQyxZQUFXQSIsImZpbGUiOiJzaGFyZWQvc2VydmljZXMvYXV0aC5zZXJ2aWNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QuZGVjb3JhdGUgPT09IFwiZnVuY3Rpb25cIikgciA9IFJlZmxlY3QuZGVjb3JhdGUoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpO1xuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcbn07XG52YXIgX19tZXRhZGF0YSA9ICh0aGlzICYmIHRoaXMuX19tZXRhZGF0YSkgfHwgZnVuY3Rpb24gKGssIHYpIHtcbiAgICBpZiAodHlwZW9mIFJlZmxlY3QgPT09IFwib2JqZWN0XCIgJiYgdHlwZW9mIFJlZmxlY3QubWV0YWRhdGEgPT09IFwiZnVuY3Rpb25cIikgcmV0dXJuIFJlZmxlY3QubWV0YWRhdGEoaywgdik7XG59O1xudmFyIGNvcmVfMSA9IHJlcXVpcmUoJ0Bhbmd1bGFyL2NvcmUnKTtcbnZhciBodHRwXzEgPSByZXF1aXJlKCdAYW5ndWxhci9odHRwJyk7XG52YXIgcm91dGVyXzEgPSByZXF1aXJlKCdAYW5ndWxhci9yb3V0ZXInKTtcbnZhciBPYnNlcnZhYmxlXzEgPSByZXF1aXJlKCdyeGpzL09ic2VydmFibGUnKTtcbnZhciBhbmd1bGFyMl9qd3RfMSA9IHJlcXVpcmUoJ2FuZ3VsYXIyLWp3dCcpO1xucmVxdWlyZSgncnhqcy9hZGQvb2JzZXJ2YWJsZS9vZicpO1xucmVxdWlyZSgncnhqcy9hZGQvb3BlcmF0b3IvZG8nKTtcbnJlcXVpcmUoJ3J4anMvYWRkL29wZXJhdG9yL2RlbGF5Jyk7XG5yZXF1aXJlKCdyeGpzL2FkZC9vcGVyYXRvci9jYXRjaCcpO1xucmVxdWlyZSgncnhqcy9hZGQvb3BlcmF0b3IvbWFwJyk7XG4vLyBVc2luZyBhdXRoIHNlcnZpY2UgdG8ga2VlcCB0cmFjayBvZiB1c2VycycgbG9naW4gc3RhdHVzIGFjcm9zcyBhbGwgY29tcG9uZW50XG52YXIgQXV0aFNlcnZpY2UgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIEF1dGhTZXJ2aWNlKGh0dHAsIGF1dGhIdHRwLCByb3V0ZXIpIHtcbiAgICAgICAgdGhpcy5odHRwID0gaHR0cDtcbiAgICAgICAgdGhpcy5hdXRoSHR0cCA9IGF1dGhIdHRwO1xuICAgICAgICB0aGlzLnJvdXRlciA9IHJvdXRlcjtcbiAgICB9XG4gICAgQXV0aFNlcnZpY2UucHJvdG90eXBlLmdldEN1cnJlbnRVc2VyID0gZnVuY3Rpb24gKHVzZXJJZCkge1xuICAgICAgICByZXR1cm4gdGhpcy5hdXRoSHR0cC5nZXQoXCIvYXBpL3VzZXIvY3VycmVudFVzZXIvXCIgKyB1c2VySWQpXG4gICAgICAgICAgICAubWFwKHRoaXMuaGFuZGVsUmVzcG9uc2UpXG4gICAgICAgICAgICAuY2F0Y2godGhpcy5oYW5kZWxFcnJvcik7XG4gICAgfTtcbiAgICBBdXRoU2VydmljZS5wcm90b3R5cGUuc2lnblVwID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5wb3N0KCcvYXBpL3VzZXIvc2lnbnVwJywgZGF0YSlcbiAgICAgICAgICAgIC5tYXAodGhpcy5oYW5kZWxSZXNwb25zZSlcbiAgICAgICAgICAgIC5jYXRjaCh0aGlzLmhhbmRlbEVycm9yKTtcbiAgICB9O1xuICAgIEF1dGhTZXJ2aWNlLnByb3RvdHlwZS5sb2dVc2VySW4gPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICByZXR1cm4gdGhpcy5odHRwLnBvc3QoJy9hcGkvdXNlci9sb2dpbicsIGRhdGEpXG4gICAgICAgICAgICAubWFwKHRoaXMuaGFuZGVsUmVzcG9uc2UpXG4gICAgICAgICAgICAuY2F0Y2godGhpcy5oYW5kZWxFcnJvcik7XG4gICAgfTtcbiAgICBBdXRoU2VydmljZS5wcm90b3R5cGUubG9nVXNlck91dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2lkX3Rva2VuJyk7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdjdXJyZW50X3VzZXInKTtcbiAgICAgICAgdGhpcy5pc0xvZ2dlZEluID0gZmFsc2U7XG4gICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFsnLyddKTtcbiAgICAgICAgcmV0dXJuICdsb2dvdXQnO1xuICAgIH07XG4gICAgQXV0aFNlcnZpY2UucHJvdG90eXBlLnVwZGF0ZVVzZXIgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAvL0Rvbid0IGxldCB1c2VyIGNoYW5nZSBwYXNzd29yZCB0aHJvdWdoIGZyb250IGVuZCwgYnV0IHRocm91Z2ggZW1haWwgcHcgcmVzZXRcbiAgICAgICAgaWYgKGRhdGEucGFzc3dvcmQgPT09IG51bGwgfHwgZGF0YS5wYXNzd29yZCkge1xuICAgICAgICAgICAgZGVsZXRlIGRhdGEucGFzc3dvcmQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5wb3N0KCcvYXBpL3VzZXIvdXBkYXRlJywgZGF0YSlcbiAgICAgICAgICAgIC5tYXAodGhpcy5oYW5kZWxSZXNwb25zZSlcbiAgICAgICAgICAgIC5jYXRjaCh0aGlzLmhhbmRlbEVycm9yKTtcbiAgICB9O1xuICAgIEF1dGhTZXJ2aWNlLnByb3RvdHlwZS5oYW5kZWxSZXNwb25zZSA9IGZ1bmN0aW9uIChyZXMpIHtcbiAgICAgICAgdmFyIGRhdGEgPSByZXMuanNvbigpO1xuICAgICAgICAvLyBjb25zb2xlLmxvZygnY2hlY2sxJywgdGhpcy5pc0xvZ2dlZEluKTtcbiAgICAgICAgdGhpcy5pc0xvZ2dlZEluID0gdHJ1ZTtcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ2NoZWNrMicsIHRoaXMuaXNMb2dnZWRJbik7XG4gICAgICAgIHRoaXMuY3VycmVudFVzZXIgPSBkYXRhO1xuICAgICAgICByZXR1cm4gZGF0YSB8fCB7fTtcbiAgICB9O1xuICAgIEF1dGhTZXJ2aWNlLnByb3RvdHlwZS5oYW5kZWxFcnJvciA9IGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2VyciBAYXV0aFNlcnZpY2U6ICcsIGVycik7XG4gICAgICAgIHRoaXMuaXNMb2dnZWRJbiA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gT2JzZXJ2YWJsZV8xLk9ic2VydmFibGUudGhyb3coZXJyKTtcbiAgICB9O1xuICAgIEF1dGhTZXJ2aWNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIGNvcmVfMS5JbmplY3RhYmxlKCksIFxuICAgICAgICBfX21ldGFkYXRhKCdkZXNpZ246cGFyYW10eXBlcycsIFtodHRwXzEuSHR0cCwgYW5ndWxhcjJfand0XzEuQXV0aEh0dHAsIHJvdXRlcl8xLlJvdXRlcl0pXG4gICAgXSwgQXV0aFNlcnZpY2UpO1xuICAgIHJldHVybiBBdXRoU2VydmljZTtcbn0oKSk7XG5leHBvcnRzLkF1dGhTZXJ2aWNlID0gQXV0aFNlcnZpY2U7XG4iLCJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBIdHRwLCBSZXNwb25zZSB9IGZyb20gJ0Bhbmd1bGFyL2h0dHAnO1xuaW1wb3J0IHsgUm91dGVyIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzL09ic2VydmFibGUnO1xuaW1wb3J0IHsgQXV0aEh0dHAgfSBmcm9tICdhbmd1bGFyMi1qd3QnO1xuXG5pbXBvcnQgJ3J4anMvYWRkL29ic2VydmFibGUvb2YnO1xuaW1wb3J0ICdyeGpzL2FkZC9vcGVyYXRvci9kbyc7XG5pbXBvcnQgJ3J4anMvYWRkL29wZXJhdG9yL2RlbGF5JztcbmltcG9ydCAncnhqcy9hZGQvb3BlcmF0b3IvY2F0Y2gnO1xuaW1wb3J0ICdyeGpzL2FkZC9vcGVyYXRvci9tYXAnO1xuXG5pbXBvcnQgeyBBdXRoIH0gZnJvbSAnLi4vdHlwZXMvYXV0aCc7XG5pbXBvcnQgeyBVc2VyIH0gZnJvbSAnLi4vdHlwZXMvdXNlcic7XG5cbi8vIFVzaW5nIGF1dGggc2VydmljZSB0byBrZWVwIHRyYWNrIG9mIHVzZXJzJyBsb2dpbiBzdGF0dXMgYWNyb3NzIGFsbCBjb21wb25lbnRcbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBBdXRoU2VydmljZSB7XG4gICAgIHB1YmxpYyBpc0xvZ2dlZEluOiBib29sZWFuO1xuICAgICBwdWJsaWMgcmVkaXJlY3RVcmw6IHN0cmluZztcbiAgICAgcHVibGljIGN1cnJlbnRVc2VyOiB7fTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGh0dHA6IEh0dHAsXG4gICAgICAgIHByaXZhdGUgYXV0aEh0dHA6IEF1dGhIdHRwLFxuICAgICAgICBwcml2YXRlIHJvdXRlcjogUm91dGVyXG4gICAgKSB7IH1cblxuICAgIGdldEN1cnJlbnRVc2VyKHVzZXJJZCk6IE9ic2VydmFibGU8VXNlcj4ge1xuICAgICAgICByZXR1cm4gdGhpcy5hdXRoSHR0cC5nZXQoYC9hcGkvdXNlci9jdXJyZW50VXNlci8ke3VzZXJJZH1gKVxuICAgICAgICAgICAgLm1hcCh0aGlzLmhhbmRlbFJlc3BvbnNlKVxuICAgICAgICAgICAgLmNhdGNoKHRoaXMuaGFuZGVsRXJyb3IpXG4gICAgfVxuXG4gICAgc2lnblVwKGRhdGE6IEF1dGgpOiBPYnNlcnZhYmxlPEF1dGg+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaHR0cC5wb3N0KCcvYXBpL3VzZXIvc2lnbnVwJywgZGF0YSlcbiAgICAgICAgICAgIC5tYXAodGhpcy5oYW5kZWxSZXNwb25zZSlcbiAgICAgICAgICAgIC5jYXRjaCh0aGlzLmhhbmRlbEVycm9yKVxuICAgIH1cblxuICAgIGxvZ1VzZXJJbihkYXRhOiBBdXRoKTogT2JzZXJ2YWJsZTxBdXRoPiB7XG4gICAgICAgIHJldHVybiB0aGlzLmh0dHAucG9zdCgnL2FwaS91c2VyL2xvZ2luJywgZGF0YSlcbiAgICAgICAgICAgIC5tYXAodGhpcy5oYW5kZWxSZXNwb25zZSlcbiAgICAgICAgICAgIC5jYXRjaCh0aGlzLmhhbmRlbEVycm9yKVxuICAgIH1cblxuICAgIGxvZ1VzZXJPdXQoKSB7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdpZF90b2tlbicpXG4gICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCdjdXJyZW50X3VzZXInKVxuICAgICAgICB0aGlzLmlzTG9nZ2VkSW4gPSBmYWxzZTtcbiAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoWycvJ10pXG4gICAgICAgIHJldHVybiAnbG9nb3V0JztcbiAgICB9XG4gICBcbiAgICB1cGRhdGVVc2VyKGRhdGE6IGFueSk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgICAgIC8vRG9uJ3QgbGV0IHVzZXIgY2hhbmdlIHBhc3N3b3JkIHRocm91Z2ggZnJvbnQgZW5kLCBidXQgdGhyb3VnaCBlbWFpbCBwdyByZXNldFxuICAgICAgICBpZihkYXRhLnBhc3N3b3JkID09PSBudWxsIHx8IGRhdGEucGFzc3dvcmQpIHtcbiAgICAgICAgICAgIGRlbGV0ZSBkYXRhLnBhc3N3b3JkXG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0aGlzLmh0dHAucG9zdCgnL2FwaS91c2VyL3VwZGF0ZScsIGRhdGEpXG4gICAgICAgICAgICAubWFwKHRoaXMuaGFuZGVsUmVzcG9uc2UpXG4gICAgICAgICAgICAuY2F0Y2godGhpcy5oYW5kZWxFcnJvcilcbiAgICB9XG5cbiAgICBoYW5kZWxSZXNwb25zZShyZXM6IFJlc3BvbnNlKSB7XG4gICAgICAgIFxuICAgICAgICBsZXQgZGF0YSA9IHJlcy5qc29uKCk7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdjaGVjazEnLCB0aGlzLmlzTG9nZ2VkSW4pO1xuICAgICAgICB0aGlzLmlzTG9nZ2VkSW4gPSB0cnVlO1xuICAgICAgICAvLyBjb25zb2xlLmxvZygnY2hlY2syJywgdGhpcy5pc0xvZ2dlZEluKTtcbiAgICAgICAgdGhpcy5jdXJyZW50VXNlciA9IGRhdGE7XG4gICAgICAgIHJldHVybiBkYXRhIHx8IHt9O1xuICAgIH1cbiAgICBcbiAgICAgaGFuZGVsRXJyb3IoZXJyOiBhbnkpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2VyciBAYXV0aFNlcnZpY2U6ICcsIGVycik7XG4gICAgICAgIHRoaXMuaXNMb2dnZWRJbiA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gT2JzZXJ2YWJsZS50aHJvdyhlcnIpO1xuICAgIH1cblxufSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
