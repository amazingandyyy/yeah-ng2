"use strict";var __decorate=this&&this.__decorate||function(e,t,o,n){var c,r=arguments.length,i=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(c=e[s])&&(i=(r<3?c(i):r>3?c(t,o,i):c(t,o))||i);return r>3&&i&&Object.defineProperty(t,o,i),i},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),SocketService=function(){function e(){var e=require("socket-client");this.socket=e.connect()}return e.prototype.addEventListener=function(e){this.socket.on(e,function(e){console.log("things from socket",e)})},e.prototype.removeEventListener=function(e){this.socket.removeAllListeners(e)},e.prototype.syncUpdates=function(e,t,o){o=o||function(){},this.socket.on(e+":save",function(e){var n=_.find(t,{_id:e._id}),c=t.indexOf(n),r="created";n?(t.splice(c,1,e),r="updated"):t.push(e),o(r,e,t)}),this.socket.on(e+":remove",function(e){var n="deleted";_.remove(t,{_id:e._id}),o(n,e,t)})},e.prototype.unsyncUpdates=function(e){this.socket.removeAllListeners(e+":save"),this.socket.removeAllListeners(e+":remove")},e=__decorate([core_1.Injectable(),__metadata("design:paramtypes",[])],e)}();exports.SocketService=SocketService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNoYXJlZC9zZXJ2aWNlcy9zb2NrZXQuc2VydmljZS5qcyIsInNoYXJlZC9zZXJ2aWNlcy9zb2NrZXQuc2VydmljZS50cyJdLCJuYW1lcyI6WyJfX2RlY29yYXRlIiwidGhpcyIsImRlY29yYXRvcnMiLCJ0YXJnZXQiLCJrZXkiLCJkZXNjIiwiZCIsImMiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJyIiwiT2JqZWN0IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiUmVmbGVjdCIsImRlY29yYXRlIiwiaSIsImRlZmluZVByb3BlcnR5IiwiX19tZXRhZGF0YSIsImsiLCJ2IiwibWV0YWRhdGEiLCJjb3JlXzEiLCJyZXF1aXJlIiwiU29ja2V0U2VydmljZSIsImlvIiwic29ja2V0IiwiY29ubmVjdCIsInByb3RvdHlwZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsIm9uIiwiZGF0YSIsImNvbnNvbGUiLCJsb2ciLCJyZW1vdmVFdmVudExpc3RlbmVyIiwicmVtb3ZlQWxsTGlzdGVuZXJzIiwic3luY1VwZGF0ZXMiLCJtb2RlbE5hbWUiLCJhcnJheSIsImNiIiwiaXRlbSIsIm9sZEl0ZW0iLCJfIiwiZmluZCIsIl9pZCIsImluZGV4IiwiaW5kZXhPZiIsInNwbGljZSIsInB1c2giLCJyZW1vdmUiLCJ1bnN5bmNVcGRhdGVzIiwiSW5qZWN0YWJsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiJBQUFBLFlBQ0EsSUFBSUEsWUFBY0MsTUFBUUEsS0FBS0QsWUFBZSxTQUFVRSxFQUFZQyxFQUFRQyxFQUFLQyxHQUM3RSxHQUEySEMsR0FBdkhDLEVBQUlDLFVBQVVDLE9BQVFDLEVBQUlILEVBQUksRUFBSUosRUFBa0IsT0FBVEUsRUFBZ0JBLEVBQU9NLE9BQU9DLHlCQUF5QlQsRUFBUUMsR0FBT0MsQ0FDckgsSUFBdUIsZ0JBQVpRLFVBQW9ELGtCQUFyQkEsU0FBUUMsU0FBeUJKLEVBQUlHLFFBQVFDLFNBQVNaLEVBQVlDLEVBQVFDLEVBQUtDLE9BQ3BILEtBQUssR0FBSVUsR0FBSWIsRUFBV08sT0FBUyxFQUFHTSxHQUFLLEVBQUdBLEtBQVNULEVBQUlKLEVBQVdhLE1BQUlMLEdBQUtILEVBQUksRUFBSUQsRUFBRUksR0FBS0gsRUFBSSxFQUFJRCxFQUFFSCxFQUFRQyxFQUFLTSxHQUFLSixFQUFFSCxFQUFRQyxLQUFTTSxFQUNoSixPQUFPSCxHQUFJLEdBQUtHLEdBQUtDLE9BQU9LLGVBQWViLEVBQVFDLEVBQUtNLEdBQUlBLEdBRTVETyxXQUFjaEIsTUFBUUEsS0FBS2dCLFlBQWUsU0FBVUMsRUFBR0MsR0FDdkQsR0FBdUIsZ0JBQVpOLFVBQW9ELGtCQUFyQkEsU0FBUU8sU0FBeUIsTUFBT1AsU0FBUU8sU0FBU0YsRUFBR0MsSUNSMUdFLE9BQUFDLFFBQTJCLGlCQUszQkMsY0FBQSxXQUdDLFFBQUFBLEtBQ0MsR0FBTUMsR0FBS0YsUUFBUSxnQkFDbkJyQixNQUFLd0IsT0FBU0QsRUFBR0UsVUF5RG5CLE1BdERDSCxHQUFBSSxVQUFBQyxpQkFBQSxTQUFpQkMsR0FDaEI1QixLQUFLd0IsT0FBT0ssR0FBR0QsRUFBTyxTQUFTRSxHQUM5QkMsUUFBUUMsSUFBSSxxQkFBc0JGLE1BSXBDUixFQUFBSSxVQUFBTyxvQkFBQSxTQUFvQkwsR0FDbkI1QixLQUFLd0IsT0FBT1UsbUJBQW1CTixJQUdoQ04sRUFBQUksVUFBQVMsWUFBQSxTQUFZQyxFQUFtQkMsRUFBbUJDLEdBQzNDQSxFQUFLQSxHQUFNLGFBS2R0QyxLQUFLd0IsT0FBT0ssR0FBR08sRUFBWSxRQUFTLFNBQVVHLEdBRTVDLEdBQUlDLEdBQVVDLEVBQUVDLEtBQUtMLEdBQVFNLElBQUtKLEVBQUtJLE1BQ25DQyxFQUFRUCxFQUFNUSxRQUFRTCxHQUN0QlosRUFBUSxTQUlSWSxJQUNGSCxFQUFNUyxPQUFPRixFQUFPLEVBQUdMLEdBQ3ZCWCxFQUFRLFdBRVJTLEVBQU1VLEtBQUtSLEdBR2JELEVBQUdWLEVBQU9XLEVBQU1GLEtBTWxCckMsS0FBS3dCLE9BQU9LLEdBQUdPLEVBQVksVUFBVyxTQUFVRyxHQUM5QyxHQUFJWCxHQUFRLFNBQ1phLEdBQUVPLE9BQU9YLEdBQVFNLElBQUtKLEVBQUtJLE1BQzNCTCxFQUFHVixFQUFPVyxFQUFNRixNQVNuQmYsRUFBQUksVUFBQXVCLGNBQUEsU0FBY2IsR0FDVnBDLEtBQUt3QixPQUFPVSxtQkFBbUJFLEVBQVksU0FDM0NwQyxLQUFLd0IsT0FBT1UsbUJBQW1CRSxFQUFZLFlBNURuRGQsRUFBQXZCLFlBQUNxQixPQUFBOEIsYUQ2RE9sQyxXQUFXLHlCQUNaTSxLQzdETTZCLFNBQUE3QixjQUFhQSIsImZpbGUiOiJzaGFyZWQvc2VydmljZXMvc29ja2V0LnNlcnZpY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2RlY29yYXRlID0gKHRoaXMgJiYgdGhpcy5fX2RlY29yYXRlKSB8fCBmdW5jdGlvbiAoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xufTtcbnZhciBfX21ldGFkYXRhID0gKHRoaXMgJiYgdGhpcy5fX21ldGFkYXRhKSB8fCBmdW5jdGlvbiAoaywgdikge1xuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShrLCB2KTtcbn07XG52YXIgY29yZV8xID0gcmVxdWlyZSgnQGFuZ3VsYXIvY29yZScpO1xuLy8gaW1wb3J0IGlvIGZyb20gJ3NvY2tldC1jbGllbnQnO1xudmFyIFNvY2tldFNlcnZpY2UgPSAoZnVuY3Rpb24gKCkge1xuICAgIGZ1bmN0aW9uIFNvY2tldFNlcnZpY2UoKSB7XG4gICAgICAgIHZhciBpbyA9IHJlcXVpcmUoJ3NvY2tldC1jbGllbnQnKTsgLy9odHRwczovL2dpdGh1Yi5jb20vc29ja2V0aW8vc29ja2V0LmlvLWNsaWVudFxuICAgICAgICB0aGlzLnNvY2tldCA9IGlvLmNvbm5lY3QoKTtcbiAgICB9XG4gICAgU29ja2V0U2VydmljZS5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB0aGlzLnNvY2tldC5vbihldmVudCwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0aGluZ3MgZnJvbSBzb2NrZXQnLCBkYXRhKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBTb2NrZXRTZXJ2aWNlLnByb3RvdHlwZS5yZW1vdmVFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHRoaXMuc29ja2V0LnJlbW92ZUFsbExpc3RlbmVycyhldmVudCk7XG4gICAgfTtcbiAgICBTb2NrZXRTZXJ2aWNlLnByb3RvdHlwZS5zeW5jVXBkYXRlcyA9IGZ1bmN0aW9uIChtb2RlbE5hbWUsIGFycmF5LCBjYikge1xuICAgICAgICBjYiA9IGNiIHx8IGZ1bmN0aW9uICgpIHsgfTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFN5bmNzIGl0ZW0gY3JlYXRpb24vdXBkYXRlcyBvbiAnbW9kZWw6c2F2ZSdcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc29ja2V0Lm9uKG1vZGVsTmFtZSArICc6c2F2ZScsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICB2YXIgb2xkSXRlbSA9IF8uZmluZChhcnJheSwgeyBfaWQ6IGl0ZW0uX2lkIH0pO1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gYXJyYXkuaW5kZXhPZihvbGRJdGVtKTtcbiAgICAgICAgICAgIHZhciBldmVudCA9ICdjcmVhdGVkJztcbiAgICAgICAgICAgIC8vIHJlcGxhY2Ugb2xkSXRlbSBpZiBpdCBleGlzdHNcbiAgICAgICAgICAgIC8vIG90aGVyd2lzZSBqdXN0IGFkZCBpdGVtIHRvIHRoZSBjb2xsZWN0aW9uXG4gICAgICAgICAgICBpZiAob2xkSXRlbSkge1xuICAgICAgICAgICAgICAgIGFycmF5LnNwbGljZShpbmRleCwgMSwgaXRlbSk7XG4gICAgICAgICAgICAgICAgZXZlbnQgPSAndXBkYXRlZCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBhcnJheS5wdXNoKGl0ZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2IoZXZlbnQsIGl0ZW0sIGFycmF5KTtcbiAgICAgICAgfSk7XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBTeW5jcyByZW1vdmVkIGl0ZW1zIG9uICdtb2RlbDpyZW1vdmUnXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnNvY2tldC5vbihtb2RlbE5hbWUgKyAnOnJlbW92ZScsIGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICAgICAgICB2YXIgZXZlbnQgPSAnZGVsZXRlZCc7XG4gICAgICAgICAgICBfLnJlbW92ZShhcnJheSwgeyBfaWQ6IGl0ZW0uX2lkIH0pO1xuICAgICAgICAgICAgY2IoZXZlbnQsIGl0ZW0sIGFycmF5KTtcbiAgICAgICAgfSk7XG4gICAgfTsgLy9FbmQgb2Ygc3luY1VwZGF0ZXNcbiAgICAvKipcbiAgICAgKiBSZW1vdmVzIGxpc3RlbmVycyBmb3IgYSBtb2RlbHMgdXBkYXRlcyBvbiB0aGUgdGhpcy5zb2NrZXRcbiAgICAgKlxuICAgICAqIEBwYXJhbSBtb2RlbE5hbWVcbiAgICAgKi9cbiAgICBTb2NrZXRTZXJ2aWNlLnByb3RvdHlwZS51bnN5bmNVcGRhdGVzID0gZnVuY3Rpb24gKG1vZGVsTmFtZSkge1xuICAgICAgICB0aGlzLnNvY2tldC5yZW1vdmVBbGxMaXN0ZW5lcnMobW9kZWxOYW1lICsgJzpzYXZlJyk7XG4gICAgICAgIHRoaXMuc29ja2V0LnJlbW92ZUFsbExpc3RlbmVycyhtb2RlbE5hbWUgKyAnOnJlbW92ZScpO1xuICAgIH07XG4gICAgU29ja2V0U2VydmljZSA9IF9fZGVjb3JhdGUoW1xuICAgICAgICBjb3JlXzEuSW5qZWN0YWJsZSgpLCBcbiAgICAgICAgX19tZXRhZGF0YSgnZGVzaWduOnBhcmFtdHlwZXMnLCBbXSlcbiAgICBdLCBTb2NrZXRTZXJ2aWNlKTtcbiAgICByZXR1cm4gU29ja2V0U2VydmljZTtcbn0oKSk7XG5leHBvcnRzLlNvY2tldFNlcnZpY2UgPSBTb2NrZXRTZXJ2aWNlO1xuIiwiaW1wb3J0IHsgSW5qZWN0YWJsZSB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuLy8gaW1wb3J0IGlvIGZyb20gJ3NvY2tldC1jbGllbnQnO1xuXG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBTb2NrZXRTZXJ2aWNlIHtcblx0c29ja2V0OiBhbnk7XG5cblx0Y29uc3RydWN0b3IoKSB7XG5cdFx0Y29uc3QgaW8gPSByZXF1aXJlKCdzb2NrZXQtY2xpZW50Jyk7IC8vaHR0cHM6Ly9naXRodWIuY29tL3NvY2tldGlvL3NvY2tldC5pby1jbGllbnRcblx0XHR0aGlzLnNvY2tldCA9IGlvLmNvbm5lY3QoKTtcblx0fVxuXG5cdGFkZEV2ZW50TGlzdGVuZXIoZXZlbnQ6IHN0cmluZykge1xuXHRcdHRoaXMuc29ja2V0Lm9uKGV2ZW50LCBmdW5jdGlvbihkYXRhKSB7XG5cdFx0XHRjb25zb2xlLmxvZygndGhpbmdzIGZyb20gc29ja2V0JywgZGF0YSk7XG5cdFx0fSk7XG5cdH1cblxuXHRyZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50OiBzdHJpbmcpIHtcblx0XHR0aGlzLnNvY2tldC5yZW1vdmVBbGxMaXN0ZW5lcnMoZXZlbnQpO1xuXHR9XG5cblx0c3luY1VwZGF0ZXMobW9kZWxOYW1lOiBzdHJpbmcsIGFycmF5OiBBcnJheTxhbnk+LCBjYjogYW55KSB7XG4gICAgICAgIGNiID0gY2IgfHwgZnVuY3Rpb24oKXt9O1xuXG5cdCAgICAvKipcblx0ICAgICAqIFN5bmNzIGl0ZW0gY3JlYXRpb24vdXBkYXRlcyBvbiAnbW9kZWw6c2F2ZSdcblx0ICAgICAqL1xuXHQgICAgdGhpcy5zb2NrZXQub24obW9kZWxOYW1lICsgJzpzYXZlJywgZnVuY3Rpb24gKGl0ZW0pIHtcblx0ICAgICAgXG5cdCAgICAgIHZhciBvbGRJdGVtID0gXy5maW5kKGFycmF5LCB7X2lkOiBpdGVtLl9pZH0pO1xuXHQgICAgICB2YXIgaW5kZXggPSBhcnJheS5pbmRleE9mKG9sZEl0ZW0pO1xuXHQgICAgICB2YXIgZXZlbnQgPSAnY3JlYXRlZCc7XG5cblx0ICAgICAgLy8gcmVwbGFjZSBvbGRJdGVtIGlmIGl0IGV4aXN0c1xuXHQgICAgICAvLyBvdGhlcndpc2UganVzdCBhZGQgaXRlbSB0byB0aGUgY29sbGVjdGlvblxuXHQgICAgICBpZiAob2xkSXRlbSkge1xuXHQgICAgICAgIGFycmF5LnNwbGljZShpbmRleCwgMSwgaXRlbSk7XG5cdCAgICAgICAgZXZlbnQgPSAndXBkYXRlZCc7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgYXJyYXkucHVzaChpdGVtKTtcblx0ICAgICAgfVxuXG5cdCAgICAgIGNiKGV2ZW50LCBpdGVtLCBhcnJheSk7XG5cdCAgICB9KTtcblxuXHQgICAgLyoqXG5cdCAgICAgKiBTeW5jcyByZW1vdmVkIGl0ZW1zIG9uICdtb2RlbDpyZW1vdmUnXG5cdCAgICAgKi9cblx0ICAgIHRoaXMuc29ja2V0Lm9uKG1vZGVsTmFtZSArICc6cmVtb3ZlJywgZnVuY3Rpb24gKGl0ZW0pIHtcblx0ICAgICAgdmFyIGV2ZW50ID0gJ2RlbGV0ZWQnO1xuXHQgICAgICBfLnJlbW92ZShhcnJheSwge19pZDogaXRlbS5faWR9KTtcblx0ICAgICAgY2IoZXZlbnQsIGl0ZW0sIGFycmF5KTtcblx0ICAgIH0pO1xuXHR9Ly9FbmQgb2Ygc3luY1VwZGF0ZXNcblxuICAgICAgLyoqXG4gICAgICAgKiBSZW1vdmVzIGxpc3RlbmVycyBmb3IgYSBtb2RlbHMgdXBkYXRlcyBvbiB0aGUgdGhpcy5zb2NrZXRcbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0gbW9kZWxOYW1lXG4gICAgICAgKi9cbiAgICB1bnN5bmNVcGRhdGVzKG1vZGVsTmFtZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuc29ja2V0LnJlbW92ZUFsbExpc3RlbmVycyhtb2RlbE5hbWUgKyAnOnNhdmUnKTtcbiAgICAgICAgdGhpcy5zb2NrZXQucmVtb3ZlQWxsTGlzdGVuZXJzKG1vZGVsTmFtZSArICc6cmVtb3ZlJyk7XG4gICAgfVxuXG59Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
