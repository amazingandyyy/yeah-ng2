"use strict";var __decorate=this&&this.__decorate||function(e,t,o,n){var c,r=arguments.length,i=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,o,n);else for(var s=e.length-1;s>=0;s--)(c=e[s])&&(i=(r<3?c(i):r>3?c(t,o,i):c(t,o))||i);return r>3&&i&&Object.defineProperty(t,o,i),i},__metadata=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},core_1=require("@angular/core"),lodash_1=require("lodash"),SocketService=function(){function e(){var e=require("socket-client");this.socket=e.connect()}return e.prototype.addEventListener=function(e){this.socket.on(e,function(e){console.log("things from socket",e)})},e.prototype.removeEventListener=function(e){this.socket.removeAllListeners(e)},e.prototype.syncUpdates=function(e,t,o){o=o||function(){},this.socket.on(e+":save",function(e){var n=lodash_1["default"].find(t,{_id:e._id}),c=t.indexOf(n),r="created";n?(t.splice(c,1,e),r="updated"):t.push(e),o(r,e,t)}),this.socket.on(e+":remove",function(e){var n="deleted";lodash_1["default"].remove(t,{_id:e._id}),o(n,e,t)})},e.prototype.unsyncUpdates=function(e){this.socket.removeAllListeners(e+":save"),this.socket.removeAllListeners(e+":remove")},e=__decorate([core_1.Injectable(),__metadata("design:paramtypes",[])],e)}();exports.SocketService=SocketService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNoYXJlZC9zZXJ2aWNlcy9zb2NrZXQuc2VydmljZS5qcyIsInNoYXJlZC9zZXJ2aWNlcy9zb2NrZXQuc2VydmljZS50cyJdLCJuYW1lcyI6WyJfX2RlY29yYXRlIiwidGhpcyIsImRlY29yYXRvcnMiLCJ0YXJnZXQiLCJrZXkiLCJkZXNjIiwiZCIsImMiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJyIiwiT2JqZWN0IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiUmVmbGVjdCIsImRlY29yYXRlIiwiaSIsImRlZmluZVByb3BlcnR5IiwiX19tZXRhZGF0YSIsImsiLCJ2IiwibWV0YWRhdGEiLCJjb3JlXzEiLCJyZXF1aXJlIiwibG9kYXNoXzEiLCJTb2NrZXRTZXJ2aWNlIiwiaW8iLCJzb2NrZXQiLCJjb25uZWN0IiwicHJvdG90eXBlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50Iiwib24iLCJkYXRhIiwiY29uc29sZSIsImxvZyIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJyZW1vdmVBbGxMaXN0ZW5lcnMiLCJzeW5jVXBkYXRlcyIsIm1vZGVsTmFtZSIsImFycmF5IiwiY2IiLCJpdGVtIiwib2xkSXRlbSIsImZpbmQiLCJfaWQiLCJpbmRleCIsImluZGV4T2YiLCJzcGxpY2UiLCJwdXNoIiwicmVtb3ZlIiwidW5zeW5jVXBkYXRlcyIsIkluamVjdGFibGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUNBLElBQUlBLFlBQWNDLE1BQVFBLEtBQUtELFlBQWUsU0FBVUUsRUFBWUMsRUFBUUMsRUFBS0MsR0FDN0UsR0FBMkhDLEdBQXZIQyxFQUFJQyxVQUFVQyxPQUFRQyxFQUFJSCxFQUFJLEVBQUlKLEVBQWtCLE9BQVRFLEVBQWdCQSxFQUFPTSxPQUFPQyx5QkFBeUJULEVBQVFDLEdBQU9DLENBQ3JILElBQXVCLGdCQUFaUSxVQUFvRCxrQkFBckJBLFNBQVFDLFNBQXlCSixFQUFJRyxRQUFRQyxTQUFTWixFQUFZQyxFQUFRQyxFQUFLQyxPQUNwSCxLQUFLLEdBQUlVLEdBQUliLEVBQVdPLE9BQVMsRUFBR00sR0FBSyxFQUFHQSxLQUFTVCxFQUFJSixFQUFXYSxNQUFJTCxHQUFLSCxFQUFJLEVBQUlELEVBQUVJLEdBQUtILEVBQUksRUFBSUQsRUFBRUgsRUFBUUMsRUFBS00sR0FBS0osRUFBRUgsRUFBUUMsS0FBU00sRUFDaEosT0FBT0gsR0FBSSxHQUFLRyxHQUFLQyxPQUFPSyxlQUFlYixFQUFRQyxFQUFLTSxHQUFJQSxHQUU1RE8sV0FBY2hCLE1BQVFBLEtBQUtnQixZQUFlLFNBQVVDLEVBQUdDLEdBQ3ZELEdBQXVCLGdCQUFaTixVQUFvRCxrQkFBckJBLFNBQVFPLFNBQXlCLE1BQU9QLFNBQVFPLFNBQVNGLEVBQUdDLElDUjFHRSxPQUFBQyxRQUEyQixpQkFFM0JDLFNBQUFELFFBQWMsVUFJZEUsY0FBQSxXQUdDLFFBQUFBLEtBQ0MsR0FBTUMsR0FBS0gsUUFBUSxnQkFDbkJyQixNQUFLeUIsT0FBU0QsRUFBR0UsVUF5RG5CLE1BdERDSCxHQUFBSSxVQUFBQyxpQkFBQSxTQUFpQkMsR0FDaEI3QixLQUFLeUIsT0FBT0ssR0FBR0QsRUFBTyxTQUFTRSxHQUM5QkMsUUFBUUMsSUFBSSxxQkFBc0JGLE1BSXBDUixFQUFBSSxVQUFBTyxvQkFBQSxTQUFvQkwsR0FDbkI3QixLQUFLeUIsT0FBT1UsbUJBQW1CTixJQUdoQ04sRUFBQUksVUFBQVMsWUFBQSxTQUFZQyxFQUFtQkMsRUFBbUJDLEdBQzNDQSxFQUFLQSxHQUFNLGFBS2R2QyxLQUFLeUIsT0FBT0ssR0FBR08sRUFBWSxRQUFTLFNBQVVHLEdBRTVDLEdBQUlDLEdBQVVuQixTQUFBQSxXQUFFb0IsS0FBS0osR0FBUUssSUFBS0gsRUFBS0csTUFDbkNDLEVBQVFOLEVBQU1PLFFBQVFKLEdBQ3RCWixFQUFRLFNBSVJZLElBQ0ZILEVBQU1RLE9BQU9GLEVBQU8sRUFBR0osR0FDdkJYLEVBQVEsV0FFUlMsRUFBTVMsS0FBS1AsR0FHYkQsRUFBR1YsRUFBT1csRUFBTUYsS0FNbEJ0QyxLQUFLeUIsT0FBT0ssR0FBR08sRUFBWSxVQUFXLFNBQVVHLEdBQzlDLEdBQUlYLEdBQVEsU0FDWlAsVUFBQUEsV0FBRTBCLE9BQU9WLEdBQVFLLElBQUtILEVBQUtHLE1BQzNCSixFQUFHVixFQUFPVyxFQUFNRixNQVNuQmYsRUFBQUksVUFBQXNCLGNBQUEsU0FBY1osR0FDVnJDLEtBQUt5QixPQUFPVSxtQkFBbUJFLEVBQVksU0FDM0NyQyxLQUFLeUIsT0FBT1UsbUJBQW1CRSxFQUFZLFlBNURuRGQsRUFBQXhCLFlBQUNxQixPQUFBOEIsYUQ2RE9sQyxXQUFXLHlCQUNaTyxLQzdETTRCLFNBQUE1QixjQUFhQSIsImZpbGUiOiJzaGFyZWQvc2VydmljZXMvc29ja2V0LnNlcnZpY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbnZhciBfX2RlY29yYXRlID0gKHRoaXMgJiYgdGhpcy5fX2RlY29yYXRlKSB8fCBmdW5jdGlvbiAoZGVjb3JhdG9ycywgdGFyZ2V0LCBrZXksIGRlc2MpIHtcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XG4gICAgZWxzZSBmb3IgKHZhciBpID0gZGVjb3JhdG9ycy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgaWYgKGQgPSBkZWNvcmF0b3JzW2ldKSByID0gKGMgPCAzID8gZChyKSA6IGMgPiAzID8gZCh0YXJnZXQsIGtleSwgcikgOiBkKHRhcmdldCwga2V5KSkgfHwgcjtcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xufTtcbnZhciBfX21ldGFkYXRhID0gKHRoaXMgJiYgdGhpcy5fX21ldGFkYXRhKSB8fCBmdW5jdGlvbiAoaywgdikge1xuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5tZXRhZGF0YSA9PT0gXCJmdW5jdGlvblwiKSByZXR1cm4gUmVmbGVjdC5tZXRhZGF0YShrLCB2KTtcbn07XG52YXIgY29yZV8xID0gcmVxdWlyZSgnQGFuZ3VsYXIvY29yZScpO1xuLy8gaW1wb3J0IGlvIGZyb20gJ3NvY2tldC1jbGllbnQnO1xudmFyIGxvZGFzaF8xID0gcmVxdWlyZSgnbG9kYXNoJyk7XG52YXIgU29ja2V0U2VydmljZSA9IChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gU29ja2V0U2VydmljZSgpIHtcbiAgICAgICAgdmFyIGlvID0gcmVxdWlyZSgnc29ja2V0LWNsaWVudCcpOyAvL2h0dHBzOi8vZ2l0aHViLmNvbS9zb2NrZXRpby9zb2NrZXQuaW8tY2xpZW50XG4gICAgICAgIHRoaXMuc29ja2V0ID0gaW8uY29ubmVjdCgpO1xuICAgIH1cbiAgICBTb2NrZXRTZXJ2aWNlLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHRoaXMuc29ja2V0Lm9uKGV2ZW50LCBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3RoaW5ncyBmcm9tIHNvY2tldCcsIGRhdGEpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFNvY2tldFNlcnZpY2UucHJvdG90eXBlLnJlbW92ZUV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5zb2NrZXQucmVtb3ZlQWxsTGlzdGVuZXJzKGV2ZW50KTtcbiAgICB9O1xuICAgIFNvY2tldFNlcnZpY2UucHJvdG90eXBlLnN5bmNVcGRhdGVzID0gZnVuY3Rpb24gKG1vZGVsTmFtZSwgYXJyYXksIGNiKSB7XG4gICAgICAgIGNiID0gY2IgfHwgZnVuY3Rpb24gKCkgeyB9O1xuICAgICAgICAvKipcbiAgICAgICAgICogU3luY3MgaXRlbSBjcmVhdGlvbi91cGRhdGVzIG9uICdtb2RlbDpzYXZlJ1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5zb2NrZXQub24obW9kZWxOYW1lICsgJzpzYXZlJywgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgIHZhciBvbGRJdGVtID0gbG9kYXNoXzEuZGVmYXVsdC5maW5kKGFycmF5LCB7IF9pZDogaXRlbS5faWQgfSk7XG4gICAgICAgICAgICB2YXIgaW5kZXggPSBhcnJheS5pbmRleE9mKG9sZEl0ZW0pO1xuICAgICAgICAgICAgdmFyIGV2ZW50ID0gJ2NyZWF0ZWQnO1xuICAgICAgICAgICAgLy8gcmVwbGFjZSBvbGRJdGVtIGlmIGl0IGV4aXN0c1xuICAgICAgICAgICAgLy8gb3RoZXJ3aXNlIGp1c3QgYWRkIGl0ZW0gdG8gdGhlIGNvbGxlY3Rpb25cbiAgICAgICAgICAgIGlmIChvbGRJdGVtKSB7XG4gICAgICAgICAgICAgICAgYXJyYXkuc3BsaWNlKGluZGV4LCAxLCBpdGVtKTtcbiAgICAgICAgICAgICAgICBldmVudCA9ICd1cGRhdGVkJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGFycmF5LnB1c2goaXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYihldmVudCwgaXRlbSwgYXJyYXkpO1xuICAgICAgICB9KTtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIFN5bmNzIHJlbW92ZWQgaXRlbXMgb24gJ21vZGVsOnJlbW92ZSdcbiAgICAgICAgICovXG4gICAgICAgIHRoaXMuc29ja2V0Lm9uKG1vZGVsTmFtZSArICc6cmVtb3ZlJywgZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgICAgICAgIHZhciBldmVudCA9ICdkZWxldGVkJztcbiAgICAgICAgICAgIGxvZGFzaF8xLmRlZmF1bHQucmVtb3ZlKGFycmF5LCB7IF9pZDogaXRlbS5faWQgfSk7XG4gICAgICAgICAgICBjYihldmVudCwgaXRlbSwgYXJyYXkpO1xuICAgICAgICB9KTtcbiAgICB9OyAvL0VuZCBvZiBzeW5jVXBkYXRlc1xuICAgIC8qKlxuICAgICAqIFJlbW92ZXMgbGlzdGVuZXJzIGZvciBhIG1vZGVscyB1cGRhdGVzIG9uIHRoZSB0aGlzLnNvY2tldFxuICAgICAqXG4gICAgICogQHBhcmFtIG1vZGVsTmFtZVxuICAgICAqL1xuICAgIFNvY2tldFNlcnZpY2UucHJvdG90eXBlLnVuc3luY1VwZGF0ZXMgPSBmdW5jdGlvbiAobW9kZWxOYW1lKSB7XG4gICAgICAgIHRoaXMuc29ja2V0LnJlbW92ZUFsbExpc3RlbmVycyhtb2RlbE5hbWUgKyAnOnNhdmUnKTtcbiAgICAgICAgdGhpcy5zb2NrZXQucmVtb3ZlQWxsTGlzdGVuZXJzKG1vZGVsTmFtZSArICc6cmVtb3ZlJyk7XG4gICAgfTtcbiAgICBTb2NrZXRTZXJ2aWNlID0gX19kZWNvcmF0ZShbXG4gICAgICAgIGNvcmVfMS5JbmplY3RhYmxlKCksIFxuICAgICAgICBfX21ldGFkYXRhKCdkZXNpZ246cGFyYW10eXBlcycsIFtdKVxuICAgIF0sIFNvY2tldFNlcnZpY2UpO1xuICAgIHJldHVybiBTb2NrZXRTZXJ2aWNlO1xufSgpKTtcbmV4cG9ydHMuU29ja2V0U2VydmljZSA9IFNvY2tldFNlcnZpY2U7XG4iLCJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG4vLyBpbXBvcnQgaW8gZnJvbSAnc29ja2V0LWNsaWVudCc7XG5pbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuXG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBTb2NrZXRTZXJ2aWNlIHtcblx0c29ja2V0OiBhbnk7XG5cblx0Y29uc3RydWN0b3IoKSB7XG5cdFx0Y29uc3QgaW8gPSByZXF1aXJlKCdzb2NrZXQtY2xpZW50Jyk7IC8vaHR0cHM6Ly9naXRodWIuY29tL3NvY2tldGlvL3NvY2tldC5pby1jbGllbnRcblx0XHR0aGlzLnNvY2tldCA9IGlvLmNvbm5lY3QoKTtcblx0fVxuXG5cdGFkZEV2ZW50TGlzdGVuZXIoZXZlbnQ6IHN0cmluZykge1xuXHRcdHRoaXMuc29ja2V0Lm9uKGV2ZW50LCBmdW5jdGlvbihkYXRhKSB7XG5cdFx0XHRjb25zb2xlLmxvZygndGhpbmdzIGZyb20gc29ja2V0JywgZGF0YSk7XG5cdFx0fSk7XG5cdH1cblxuXHRyZW1vdmVFdmVudExpc3RlbmVyKGV2ZW50OiBzdHJpbmcpIHtcblx0XHR0aGlzLnNvY2tldC5yZW1vdmVBbGxMaXN0ZW5lcnMoZXZlbnQpO1xuXHR9XG5cblx0c3luY1VwZGF0ZXMobW9kZWxOYW1lOiBzdHJpbmcsIGFycmF5OiBBcnJheTxhbnk+LCBjYjogYW55KSB7XG4gICAgICAgIGNiID0gY2IgfHwgZnVuY3Rpb24oKXt9O1xuXG5cdCAgICAvKipcblx0ICAgICAqIFN5bmNzIGl0ZW0gY3JlYXRpb24vdXBkYXRlcyBvbiAnbW9kZWw6c2F2ZSdcblx0ICAgICAqL1xuXHQgICAgdGhpcy5zb2NrZXQub24obW9kZWxOYW1lICsgJzpzYXZlJywgZnVuY3Rpb24gKGl0ZW0pIHtcblx0ICAgICAgXG5cdCAgICAgIHZhciBvbGRJdGVtID0gXy5maW5kKGFycmF5LCB7X2lkOiBpdGVtLl9pZH0pO1xuXHQgICAgICB2YXIgaW5kZXggPSBhcnJheS5pbmRleE9mKG9sZEl0ZW0pO1xuXHQgICAgICB2YXIgZXZlbnQgPSAnY3JlYXRlZCc7XG5cblx0ICAgICAgLy8gcmVwbGFjZSBvbGRJdGVtIGlmIGl0IGV4aXN0c1xuXHQgICAgICAvLyBvdGhlcndpc2UganVzdCBhZGQgaXRlbSB0byB0aGUgY29sbGVjdGlvblxuXHQgICAgICBpZiAob2xkSXRlbSkge1xuXHQgICAgICAgIGFycmF5LnNwbGljZShpbmRleCwgMSwgaXRlbSk7XG5cdCAgICAgICAgZXZlbnQgPSAndXBkYXRlZCc7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgYXJyYXkucHVzaChpdGVtKTtcblx0ICAgICAgfVxuXG5cdCAgICAgIGNiKGV2ZW50LCBpdGVtLCBhcnJheSk7XG5cdCAgICB9KTtcblxuXHQgICAgLyoqXG5cdCAgICAgKiBTeW5jcyByZW1vdmVkIGl0ZW1zIG9uICdtb2RlbDpyZW1vdmUnXG5cdCAgICAgKi9cblx0ICAgIHRoaXMuc29ja2V0Lm9uKG1vZGVsTmFtZSArICc6cmVtb3ZlJywgZnVuY3Rpb24gKGl0ZW0pIHtcblx0ICAgICAgdmFyIGV2ZW50ID0gJ2RlbGV0ZWQnO1xuXHQgICAgICBfLnJlbW92ZShhcnJheSwge19pZDogaXRlbS5faWR9KTtcblx0ICAgICAgY2IoZXZlbnQsIGl0ZW0sIGFycmF5KTtcblx0ICAgIH0pO1xuXHR9Ly9FbmQgb2Ygc3luY1VwZGF0ZXNcblxuICAgICAgLyoqXG4gICAgICAgKiBSZW1vdmVzIGxpc3RlbmVycyBmb3IgYSBtb2RlbHMgdXBkYXRlcyBvbiB0aGUgdGhpcy5zb2NrZXRcbiAgICAgICAqXG4gICAgICAgKiBAcGFyYW0gbW9kZWxOYW1lXG4gICAgICAgKi9cbiAgICB1bnN5bmNVcGRhdGVzKG1vZGVsTmFtZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMuc29ja2V0LnJlbW92ZUFsbExpc3RlbmVycyhtb2RlbE5hbWUgKyAnOnNhdmUnKTtcbiAgICAgICAgdGhpcy5zb2NrZXQucmVtb3ZlQWxsTGlzdGVuZXJzKG1vZGVsTmFtZSArICc6cmVtb3ZlJyk7XG4gICAgfVxuXG59Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
